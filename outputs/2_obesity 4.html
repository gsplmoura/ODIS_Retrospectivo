<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Gustavo Santos Paiva Laender Moura">
<meta name="dcterms.date" content="2025-08-23">

<title>ODIS Retrospectivo Data Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="2_obesity_files/libs/clipboard/clipboard.min.js"></script>
<script src="2_obesity_files/libs/quarto-html/quarto.js"></script>
<script src="2_obesity_files/libs/quarto-html/popper.min.js"></script>
<script src="2_obesity_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="2_obesity_files/libs/quarto-html/anchor.min.js"></script>
<link href="2_obesity_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="2_obesity_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="2_obesity_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="2_obesity_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="2_obesity_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<style>html{ scroll-behavior: smooth; }</style>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#consultas" id="toc-consultas" class="nav-link active" data-scroll-target="#consultas">Consultas</a></li>
  <li><a href="#filtrando-a-amostra" id="toc-filtrando-a-amostra" class="nav-link" data-scroll-target="#filtrando-a-amostra">Filtrando a amostra</a>
  <ul>
  <li><a href="#por-imc" id="toc-por-imc" class="nav-link" data-scroll-target="#por-imc">Por IMC</a></li>
  <li><a href="#por-idade" id="toc-por-idade" class="nav-link" data-scroll-target="#por-idade">Por idade</a>
  <ul>
  <li><a href="#interseção-evalfalse" id="toc-interseção-evalfalse" class="nav-link" data-scroll-target="#interseção-evalfalse">Interseção (eval=false)</a></li>
  <li><a href="#exclusão-de-pacientes-menores-de-idade" id="toc-exclusão-de-pacientes-menores-de-idade" class="nav-link" data-scroll-target="#exclusão-de-pacientes-menores-de-idade">Exclusão de pacientes menores de idade</a></li>
  </ul></li>
  <li><a href="#consultas-1" id="toc-consultas-1" class="nav-link" data-scroll-target="#consultas-1">≥ 2 consultas</a>
  <ul>
  <li><a href="#pipe-table" id="toc-pipe-table" class="nav-link" data-scroll-target="#pipe-table">Pipe table</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#objetivos" id="toc-objetivos" class="nav-link" data-scroll-target="#objetivos">Objetivos</a>
  <ul>
  <li><a href="#objetivo-geral" id="toc-objetivo-geral" class="nav-link" data-scroll-target="#objetivo-geral">Objetivo Geral</a></li>
  <li><a href="#escolha-do-dataset" id="toc-escolha-do-dataset" class="nav-link" data-scroll-target="#escolha-do-dataset">Escolha do dataset</a></li>
  <li><a href="#componente-descritivo" id="toc-componente-descritivo" class="nav-link" data-scroll-target="#componente-descritivo">1. Componente descritivo</a>
  <ul>
  <li><a href="#perfil-epidemiológico-na-primeira-consulta-idade-sexo-etnia-imc-comorbidades." id="toc-perfil-epidemiológico-na-primeira-consulta-idade-sexo-etnia-imc-comorbidades." class="nav-link" data-scroll-target="#perfil-epidemiológico-na-primeira-consulta-idade-sexo-etnia-imc-comorbidades.">1.1. Perfil epidemiológico na primeira consulta: idade, sexo, etnia, IMC, comorbidades.</a></li>
  <li><a href="#indicadores-de-atendimento-número-de-consultas-e-tempo-de-seguimento." id="toc-indicadores-de-atendimento-número-de-consultas-e-tempo-de-seguimento." class="nav-link" data-scroll-target="#indicadores-de-atendimento-número-de-consultas-e-tempo-de-seguimento.">1.3. Indicadores de atendimento: número de consultas e tempo de seguimento.</a></li>
  <li><a href="#proporção-de-indivíduos-com-peso-final-maior-que-o-inicial." id="toc-proporção-de-indivíduos-com-peso-final-maior-que-o-inicial." class="nav-link" data-scroll-target="#proporção-de-indivíduos-com-peso-final-maior-que-o-inicial.">1.6. Proporção de indivíduos com peso final maior que o inicial.</a></li>
  <li><a href="#proporção-de-consultas-a-partir-da-segunda-com-ganho-ou-perda-de-peso-em-relação-à-anteriorbaseline." id="toc-proporção-de-consultas-a-partir-da-segunda-com-ganho-ou-perda-de-peso-em-relação-à-anteriorbaseline." class="nav-link" data-scroll-target="#proporção-de-consultas-a-partir-da-segunda-com-ganho-ou-perda-de-peso-em-relação-à-anteriorbaseline.">1.7. Proporção de consultas (a partir da segunda) com ganho ou perda de peso em relação à anterior/baseline.</a></li>
  </ul></li>
  <li><a href="#análises-pelo-tempo-de-seguimento" id="toc-análises-pelo-tempo-de-seguimento" class="nav-link" data-scroll-target="#análises-pelo-tempo-de-seguimento">2. Análises pelo tempo de seguimento</a>
  <ul>
  <li><a href="#comparar-a-porcentagem-máxima-de-perda-de-peso-entre-seguimento-12-meses-e-12-meses-ajustando-por-sexo-etnia-idade-imc-inicial-comorbidades-e-uso-de-medicação." id="toc-comparar-a-porcentagem-máxima-de-perda-de-peso-entre-seguimento-12-meses-e-12-meses-ajustando-por-sexo-etnia-idade-imc-inicial-comorbidades-e-uso-de-medicação." class="nav-link" data-scroll-target="#comparar-a-porcentagem-máxima-de-perda-de-peso-entre-seguimento-12-meses-e-12-meses-ajustando-por-sexo-etnia-idade-imc-inicial-comorbidades-e-uso-de-medicação.">2.1. Comparar a porcentagem máxima de perda de peso entre seguimento ≤12 meses e &gt;12 meses, ajustando por sexo, etnia, idade, IMC inicial, (comorbidades e uso de medicação).</a></li>
  <li><a href="#avaliar-associação-da-perda-de-peso-máxima-com-variáveis-demográficas-clínicas-e-de-seguimento." id="toc-avaliar-associação-da-perda-de-peso-máxima-com-variáveis-demográficas-clínicas-e-de-seguimento." class="nav-link" data-scroll-target="#avaliar-associação-da-perda-de-peso-máxima-com-variáveis-demográficas-clínicas-e-de-seguimento.">2.2. Avaliar associação da perda de peso máxima com variáveis demográficas, (clínicas) e de seguimento.</a></li>
  <li><a href="#descrever-o-momento-em-que-cada-indivíduo-atingiu-5-de-perda-em-relação-ao-peso-inicial." id="toc-descrever-o-momento-em-que-cada-indivíduo-atingiu-5-de-perda-em-relação-ao-peso-inicial." class="nav-link" data-scroll-target="#descrever-o-momento-em-que-cada-indivíduo-atingiu-5-de-perda-em-relação-ao-peso-inicial.">2.3. Descrever o momento em que cada indivíduo atingiu ≥5% de perda em relação ao peso inicial.</a></li>
  </ul></li>
  <li><a href="#subgrupo-com-perda-5-alvo_atingido" id="toc-subgrupo-com-perda-5-alvo_atingido" class="nav-link" data-scroll-target="#subgrupo-com-perda-5-alvo_atingido">3. Subgrupo com perda ≥5% (<code>alvo_atingido</code>)</a>
  <ul>
  <li><a href="#identificar-o-tempo-e-a-consulta-da-primeira-observação-de-perda-5." id="toc-identificar-o-tempo-e-a-consulta-da-primeira-observação-de-perda-5." class="nav-link" data-scroll-target="#identificar-o-tempo-e-a-consulta-da-primeira-observação-de-perda-5.">3.1. Identificar o tempo e a consulta da primeira observação de perda ≥5%.</a></li>
  <li><a href="#explorar-o-padrão-de-peso-após-atingir-essa-meta." id="toc-explorar-o-padrão-de-peso-após-atingir-essa-meta." class="nav-link" data-scroll-target="#explorar-o-padrão-de-peso-após-atingir-essa-meta.">3.2. Explorar o padrão de peso após atingir essa meta.</a></li>
  <li><a href="#comparar-a-perda-máxima-entre-subgrupos-6-meses-612-meses-12-meses." id="toc-comparar-a-perda-máxima-entre-subgrupos-6-meses-612-meses-12-meses." class="nav-link" data-scroll-target="#comparar-a-perda-máxima-entre-subgrupos-6-meses-612-meses-12-meses.">3.3. Comparar a perda máxima entre subgrupos (≤6 meses, 6–12 meses, &gt;12 meses).</a></li>
  </ul></li>
  <li><a href="#grupo-sem-perda-5" id="toc-grupo-sem-perda-5" class="nav-link" data-scroll-target="#grupo-sem-perda-5">4. Grupo sem perda ≥5%</a>
  <ul>
  <li><a href="#identificar-tempo-de-seguimento-e-consulta-com-maior-perda-observada." id="toc-identificar-tempo-de-seguimento-e-consulta-com-maior-perda-observada." class="nav-link" data-scroll-target="#identificar-tempo-de-seguimento-e-consulta-com-maior-perda-observada.">4.1. Identificar tempo de seguimento e consulta com maior perda observada.</a></li>
  <li><a href="#descrever-o-ganho-de-peso-após-esse-momento." id="toc-descrever-o-ganho-de-peso-após-esse-momento." class="nav-link" data-scroll-target="#descrever-o-ganho-de-peso-após-esse-momento.">4.2. Descrever o ganho de peso após esse momento.</a></li>
  </ul></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="2_obesity.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">ODIS Retrospectivo Data Analysis</h1>
<p class="subtitle lead">Análise dos dados dos pacientes com obesidade</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Gustavo Santos Paiva Laender Moura </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">August 23, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div class="cell" data-layout-align="center">
<div style="page-break-after: always;"></div>
</div>
<section id="consultas" class="level1">
<h1>Consultas</h1>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 17 Columns: 4
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (4): variable, type, levels, description

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<p>O banco de dados <code>consultas</code> reúne 5.202 observações referentes a consultas médicas de 872 pacientes distintos, identificados de forma única pela variável record_id. O conjunto contém 17 variáveis, abrangendo informações sociodemográficas, datas de atendimento, medidas antropométricas e indicadores derivados do seguimento longitudinal. As variáveis incluem dados fixos, como birthdate (data de nascimento), sex e race, além de variáveis temporais (date_consultation, date_weight, baseline_date) que permitem acompanhar a evolução clínica ao longo do tempo. Foram incorporadas medidas diretas, como weight_kg e height_m, e variáveis calculadas, como o índice de massa corporal (bmi) e a perda percentual de peso em relação ao valor basal (percent_weight_loss).</p>
<p>O dataset apresenta algumas particularidades em termos de completude: enquanto variáveis como age, sex e race estão completas para todos os registros, há proporções relevantes de dados faltantes em weight_kg (cerca de 20%) e, consequentemente, em variáveis derivadas como bmi e percent_weight_loss. A variável height_m, definida pela mediana das medidas disponíveis por paciente ou complementada via prontuário, apresenta taxa de preenchimento próxima de 100%. As medidas temporais mostram amplitude de acompanhamento de janeiro de 2016 a outubro de 2023, com variação importante no número de consultas por paciente (mediana de 4 consultas, podendo chegar a mais de 30).</p>
<p>Em síntese, consultas constitui uma base de dados longitudinal, estruturada de modo que cada linha representa uma consulta de um paciente em determinada data, trazendo consigo tanto informações fixas (características do indivíduo) quanto variáveis dinâmicas (peso, IMC, perda relativa de peso), permitindo análises temporais da trajetória clínica dos indivíduos.</p>
</section>
<section id="filtrando-a-amostra" class="level1">
<h1>Filtrando a amostra</h1>
<section id="por-imc" class="level2">
<h2 class="anchored" data-anchor-id="por-imc">Por IMC</h2>
<p>Esse código cria um novo dataframe chamado <code>consultas_bmi</code> a partir do dataframe <code>consultas</code>, selecionando apenas os pacientes que em algum momento do seguimento apresentaram IMC ≥ 30 kg/m² (critério de obesidade).</p>
<p>Depois de aplicar o filtro, o dataframe consultas (5.202 consultas, 872 pacientes) passou a conter apenas os pacientes que apresentaram IMC ≥ 30 em pelo menos uma consulta, resultando no novo dataframe obese. O dataframe obese mantém a mesma estrutura de variáveis (17 colunas), mas contém menos pacientes (695) e menos consultas (4.102), restrito àqueles que tiveram obesidade (IMC ≥ 30) em pelo menos uma avaliação. Esse subconjunto apresenta peso e IMC médios mais altos, idade média ligeiramente menor e preserva as distribuições de sexo, raça e período de acompanhamento do banco original.</p>
<blockquote class="blockquote">
<p>O que mudou em relação ao original:</p>
</blockquote>
<ul>
<li>O número de <em>pacientes</em> reduziu de 872 para 695, com exclusão de 177 (20,3%) pacientes que nunca tiveram IMC ≥ 30.</li>
<li>O número de <em>consultas</em> reduziu de 5.202 para 4.102, com exclusão de 1100 (21,2%) consultas de pacientes que nunca tiveram IMC ≥ 30.</li>
<li>Distribuição <em>etária</em>: a média de idade diminuiu de ~47,3 anos para ~45,7 anos, indicando que a subamostra de obesos é um pouco mais jovem.</li>
<li><em>Sexo</em>: mantém-se a predominância feminina [F: 2.627 (60.2%) vs.&nbsp;M: 1.475 (64%)], com leve aumento proporcional de mulheres.</li>
<li><em>Raça</em>: permanece similar, mas com leve redução proporcional dos registros classificados como “VERIFICAR”.</li>
<li><em>Peso</em> médio subiu de ~117 kg para ~130 kg.</li>
<li><em>IMC</em> médio subiu de ~42,9 para ~47,5, com valores mínimos de 19,8 (pois algumas consultas de obesos podem ter IMC &lt; 30, mas o paciente já foi obeso em outra consulta).</li>
<li><em>Altura</em> média manteve-se estável (1,64 m → 1,65 m).</li>
<li><em>Perda percentual</em> de peso (percent_weight_loss): distribuição semelhante, mas agora restrita ao grupo com obesidade em algum momento.</li>
<li>Datas: período de acompanhamento se mantém (2016–2023), apenas com redução no número de observações.</li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 30%">
<col style="width: 29%">
<col style="width: 40%">
</colgroup>
<thead>
<tr class="header">
<th>Característica</th>
<th>consultas (original)</th>
<th>novo (IMC ≥ 30 em ≥1 consulta)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Nº de pacientes</td>
<td>872</td>
<td>695 (79.7%) / perda de 20.3%</td>
</tr>
<tr class="even">
<td>Nº de consultas</td>
<td>5.202</td>
<td>4.102</td>
</tr>
<tr class="odd">
<td>Idade média (anos)</td>
<td>47,3</td>
<td>45,7</td>
</tr>
<tr class="even">
<td>Peso médio (kg)</td>
<td>117</td>
<td>130</td>
</tr>
<tr class="odd">
<td>IMC médio (kg/m²)</td>
<td>42,9</td>
<td>47,5</td>
</tr>
<tr class="even">
<td>Altura média (m)</td>
<td>1,64</td>
<td>1,65</td>
</tr>
<tr class="odd">
<td>% de mulheres</td>
<td>60,2% (3.133/5.202)</td>
<td>64,0% (2.627/4.102)</td>
</tr>
<tr class="even">
<td>Período das consultas</td>
<td>2016–2023</td>
<td>2016–2023</td>
</tr>
</tbody>
</table>
</section>
<section id="por-idade" class="level2">
<h2 class="anchored" data-anchor-id="por-idade">Por idade</h2>
<section id="interseção-evalfalse" class="level3">
<h3 class="anchored" data-anchor-id="interseção-evalfalse">Interseção (eval=false)</h3>
<p>Nesta primeira opção, os pacientes que foram atendidos enquanto ainda eram menores de idade (idade &lt; 18 anos) e que também tiveram consultas na vida adulta (idade ≥ 18 anos) são mantidos. O código a seguir filtra os pacientes obesos, mantendo apenas aqueles que tiveram pelo menos uma consulta na vida adulta, e exclui os que foram atendidos exclusivamente antes dos 18 anos.</p>
<blockquote class="blockquote">
<p>Primeira opção (obese_intersect): inclui todos os pacientes com pelo menos uma consulta ≥ 18 anos (mesmo que tenham histórico antes dos 18).</p>
</blockquote>
<div class="cell" data-layout-align="center" data-evaluate="false">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>consultas_underage <span class="ot">&lt;-</span> consultas_bmi <span class="sc">%&gt;%</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(age)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(age <span class="sc">&lt;</span> <span class="dv">18</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(record_id, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   Ordena o dataframe obese por idade decrescente (arrange(desc(age))).</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtra apenas registros de pacientes com idade &lt; 18 anos.</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Usa distinct(record_id, .keep_all = TRUE) → mantém apenas uma linha por paciente.</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Como está ordenado em ordem decrescente de idade, fica registrada a maior idade do paciente enquanto menor de idade.</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Resultado: cada paciente aparece uma única vez, representando sua consulta mais velha antes dos 18 anos.</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>consultas_adults <span class="ot">&lt;-</span> consultas_bmi <span class="sc">%&gt;%</span> </span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(age)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>            ) <span class="sc">%&gt;%</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(age <span class="sc">&gt;=</span> <span class="dv">18</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>           ) <span class="sc">%&gt;%</span> </span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(record_id, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="co">#   Mesmo processo, mas agora para pacientes com idade ≥ 18 anos.</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Resultado: cada paciente aparece uma vez, representando sua consulta mais velha em idade adulta.</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>consultas_adults_records <span class="ot">&lt;-</span> consultas_adults <span class="sc">%&gt;%</span> <span class="fu">pull</span>(record_id)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Cria um vetor (character) contendo os IDs (record_id) de todos os pacientes que têm pelo menos uma consulta na idade adulta.</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>common_record_ids <span class="ot">&lt;-</span> <span class="fu">intersect</span>(consultas_underage<span class="sc">$</span>record_id, consultas_adults<span class="sc">$</span>record_id)</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Identifica os pacientes que aparecem nos dois grupos (ou seja, têm registro tanto antes quanto depois dos 18 anos).</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a><span class="co"># intersect() retorna o conjunto de record_id comum aos dois dataframes.</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>obese_intersect <span class="ot">&lt;-</span> consultas_bmi <span class="sc">%&gt;%</span> </span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>    record_id <span class="sc">%in%</span> consultas_adults_records</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>O código divide os pacientes obesos em dois subconjuntos: aqueles que tiveram consultas ainda menores de 18 anos e aqueles que já tiveram consultas na vida adulta. Para cada paciente, mantém apenas uma linha representando a consulta de maior idade em cada fase. Além disso, identifica o subconjunto de pacientes que estavam presentes em ambas as fases de acompanhamento, ou seja, que iniciaram o seguimento quando menores de idade e continuaram após atingir a maioridade. Com base nisso, o passo final cria o dataframe <code>obese</code> que contém apenas pacientes com ao menos uma consulta na vida adulta (filtra-se <code>consultas_bmi</code> mantendo os registros cujo <code>record_id</code> aparece em <code>consultas_adults_records</code>). Assim, todos os indivíduos acompanhados exclusivamente antes dos 18 anos são excluídos do conjunto principal, enquanto os que atingiram a maioridade permanecem para as análises. O vetor <code>common_record_ids</code> continua disponível caso seja necessário isolar, em análises específicas, o subgrupo que <strong>transitou</strong> de menor para adulto (isto é, pacientes com histórico em ambas as fases).</p>
<p>Um total de 11 pacientes foram atendidos na clínica enquanto ainda eram menores de idade, correspondendo a 140 consultas médicas. Destes, 4 continuaram o acompanhamento após atingirem a maioridade, restando apenas 7 pacientes que não completaram a maioridade durante o período de acompanhamento.</p>
<p><code>obese_intersect</code> é o dataset de consultas contendo os registros dos pacientes maiores de idade que tiveram pelo menos um IMC &gt; 30 e acompanhados durante o período de interesse, com um total de 4062 consultas médicas.</p>
</section>
<section id="exclusão-de-pacientes-menores-de-idade" class="level3">
<h3 class="anchored" data-anchor-id="exclusão-de-pacientes-menores-de-idade">Exclusão de pacientes menores de idade</h3>
<blockquote class="blockquote">
<p>Segunda opção (obese_adults_only): inclui apenas pacientes que entraram no acompanhamento já adultos, eliminando qualquer paciente que teve consulta como menor de idade.</p>
</blockquote>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Identifica todos os pacientes que tiveram consultas &lt; 18 anos</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>underage_records <span class="ot">&lt;-</span> consultas_bmi <span class="sc">%&gt;%</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(age <span class="sc">&lt;</span> <span class="dv">18</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(record_id) <span class="sc">%&gt;%</span> </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>()</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Cria o dataset 'obese' apenas com consultas de pacientes adultos</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co">#    que nunca tiveram consulta como menores de idade</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>consultas_adults <span class="ot">&lt;-</span> consultas_bmi <span class="sc">%&gt;%</span> </span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    age <span class="sc">&gt;=</span> <span class="dv">18</span>,                           <span class="co"># garante só idade adulta</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span>(record_id <span class="sc">%in%</span> underage_records))  <span class="co"># exclui quem já foi &lt;18</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>O código acima cria um novo dataframe chamado <code>consultas_adults</code>, que contém apenas os pacientes que foram atendidos exclusivamente na vida adulta (idade ≥ 18 anos). Pacientes que tiveram consultas enquanto menores de idade são completamente excluídos do conjunto.</p>
<blockquote class="blockquote">
<p>O que mudou em <code>consultas_adults</code> em relação a <code>consultas_bmi</code>:</p>
</blockquote>
<p>Comparativo objetivo do que mudou ao excluir qualquer paciente que já teve consulta &lt; 18 anos (passando de consultas_bmi → consultas_adults):</p>
<ul>
<li>Número de <code>consultas</code>: linhas caíram de 4.102 para 4.039 (n=63; redução de −1,5%).</li>
<li><code>Pacientes</code> únicos: de 695 para 684 (n=11; redução de −1,6%).</li>
<li><code>Idade</code>: mínimo subiu de 5,68 para 18,0 anos (como esperado); média levemente maior (45,7 → 46,2).</li>
<li><code>Sexo</code>: % de mulheres praticamente estável (64,0% → 64,4%; 2.627/4.102 vs.&nbsp;2.600/4.039).</li>
<li><code>Antropometria</code>: médias muito semelhantes (peso ~130 kg; IMC 47,5 → 47,6); leve redução no desvio-padrão do peso (38,3 → 37,9).</li>
<li>Completude: pequenos ganhos — faltantes em weight_kg e bmi caem de 790 para 784; percent_weight_loss de 1.384 para 1.369.</li>
<li>Período de consultas permanece 2016–2023.</li>
</ul>
<blockquote class="blockquote">
<p>Pipe table:</p>
</blockquote>
<table class="caption-top table">
<colgroup>
<col style="width: 34%">
<col style="width: 30%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Métrica</strong></th>
<th><strong>Antes:</strong> consultas_bmi</th>
<th><strong>Depois:</strong> consultas_adults</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Linhas (consultas)</td>
<td>4.102</td>
<td>4.039</td>
</tr>
<tr class="even">
<td>Pacientes únicos (record_id)</td>
<td>695</td>
<td>684</td>
</tr>
<tr class="odd">
<td>Idade média (anos)</td>
<td>45,7</td>
<td>46,2</td>
</tr>
<tr class="even">
<td>Idade mínima (anos)</td>
<td>5,68</td>
<td>18,0</td>
</tr>
<tr class="odd">
<td>Mulheres, n (%)</td>
<td>2.627 (64,0%)</td>
<td>2.600 (64,4%)</td>
</tr>
<tr class="even">
<td>Peso médio (kg)</td>
<td>130</td>
<td>130</td>
</tr>
<tr class="odd">
<td>IMC médio (kg/m²)</td>
<td>47,5</td>
<td>47,6</td>
</tr>
<tr class="even">
<td>weight_kg faltante (n)</td>
<td>790</td>
<td>784</td>
</tr>
<tr class="odd">
<td>bmi faltante (n)</td>
<td>790</td>
<td>784</td>
</tr>
<tr class="even">
<td>percent_weight_loss faltante</td>
<td>1.384</td>
<td>1.369</td>
</tr>
</tbody>
</table>
<p>Interpretação: a exclusão dos pacientes com histórico de consultas na menoridade produz um conjunto estritamente adulto, com mudanças mínimas nas estatísticas descritivas e pequena redução do número de registros e pacientes. Isso sugere que a fração de indivíduos com histórico &lt;18 anos era relativamente pequena e não distorcia substancialmente as médias antropométricas do grupo.</p>
</section>
</section>
<section id="consultas-1" class="level2">
<h2 class="anchored" data-anchor-id="consultas-1">≥ 2 consultas</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>consultas_2_visits <span class="ot">&lt;-</span> consultas_adults <span class="sc">%&gt;%</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(record_id) <span class="sc">%&gt;%</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># agrupando os dados por `record_id` (identificador único do paciente) e mantendo apenas aqueles grupos (pacientes) que possuem duas ou mais observações (consultas). O resultado é um conjunto de dados que exclui pacientes com apenas uma consulta.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Esse código cria um novo dataframe chamado <code>consultas_2_visits</code>, que contém apenas os pacientes que tiveram pelo menos duas consultas médicas registradas.</p>
<blockquote class="blockquote">
<p>O que mudou em <code>consultas_2_visits</code> em relação a <code>consultas_adults</code>:</p>
</blockquote>
<p>Comparativo objetivo do que mudou ao exigir ≥2 consultas por paciente (passando de <code>consultas_adults</code> para <code>consultas_2_visits</code>):</p>
<ul>
<li><strong>Número de consultas</strong>: linhas caíram de 4.039 para 3.929 (n=110; redução de −2,7%).<br>
</li>
<li><strong>Pacientes únicos</strong>: de 684 para 574 (n=110; redução de −16,1%), correspondendo justamente aos que tinham apenas uma consulta.<br>
</li>
<li><strong>Idade</strong>: média praticamente inalterada (46,2 → 46,3 anos); mínima continua em 18 anos.<br>
</li>
<li><strong>Sexo</strong>: % de mulheres estável (64,4% → 64,3%; 2.600/4.039 vs.&nbsp;2.523/3.929).<br>
</li>
<li><strong>Antropometria</strong>: valores médios quase idênticos (peso ~130 kg; IMC 47,6 → 47,6).<br>
</li>
<li><strong>Completude</strong>: leve melhora na proporção de dados completos, já que pacientes de consulta única (com mais risco de faltar medidas) foram removidos — ex: <code>percent_weight_loss</code> faltante reduziu de 1.369 para 1.259 (N=110).</li>
</ul>
<section id="pipe-table" class="level3">
<h3 class="anchored" data-anchor-id="pipe-table">Pipe table</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 31%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Métrica</strong></th>
<th><strong>Antes:</strong> consultas_adults</th>
<th><strong>Depois:</strong> consultas_2_visits</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Linhas (consultas)</td>
<td>4.039</td>
<td>3.929</td>
</tr>
<tr class="even">
<td>Pacientes únicos (record_id)</td>
<td>684</td>
<td>574</td>
</tr>
<tr class="odd">
<td>Idade média (anos)</td>
<td>46,2</td>
<td>46,3</td>
</tr>
<tr class="even">
<td>Idade mínima (anos)</td>
<td>18,0</td>
<td>18,0</td>
</tr>
<tr class="odd">
<td>Mulheres, n (%)</td>
<td>2.600 (64,4%)</td>
<td>2.523 (64,3%)</td>
</tr>
<tr class="even">
<td>Peso médio (kg)</td>
<td>130</td>
<td>130</td>
</tr>
<tr class="odd">
<td>IMC médio (kg/m²)</td>
<td>47,6</td>
<td>47,6</td>
</tr>
<tr class="even">
<td>weight_kg faltante (n)</td>
<td>784</td>
<td>784</td>
</tr>
<tr class="odd">
<td>bmi faltante (n)</td>
<td>784</td>
<td>784</td>
</tr>
<tr class="even">
<td>percent_weight_loss faltante</td>
<td>1.369</td>
<td>1.259</td>
</tr>
</tbody>
</table>
<p><strong>Interpretação:</strong> ao excluir pacientes com apenas uma consulta, reduz-se de forma significativa o número de indivíduos (−16%), mas mantém-se praticamente inalterado o perfil clínico (idade, sexo, peso e IMC médios). O conjunto resultante é mais adequado para análises longitudinais de evolução, pois garante acompanhamento mínimo de duas consultas por paciente.</p>
</section>
</section>
</section>
<section id="objetivos" class="level1">
<h1>Objetivos</h1>
<section id="objetivo-geral" class="level2">
<h2 class="anchored" data-anchor-id="objetivo-geral">Objetivo Geral</h2>
<p>Analisar as medidas de frequência, tendência central e dispersão associadas ao tratamento da obesidade, visando identificar variáveis clínicas e epidemiológicas associadas a melhor resposta ao tratamento clínico da obesidade.</p>
<ol type="1">
<li><p>Componente descritivo<br>
1.1. * Perfil epidemiológico na primeira consulta: idade, sexo, etnia, IMC, comorbidades.<br>
1.2. Incidência de doenças cardiovasculares, osteometabólicas, anemias e deficiências vitamínicas.<br>
1.3. * Indicadores de atendimento: número de consultas e tempo de seguimento.<br>
1.4. Tipos de tratamentos prescritos para obesidade e dislipidemia e sua frequência.<br>
1.5. Causa dos 95 óbitos.<br>
1.6. * Proporção de indivíduos com peso final maior que o inicial.<br>
1.7. * Proporção de consultas (a partir da segunda) com ganho ou perda de peso em relação à anterior.</p></li>
<li><p>Análises pelo tempo de seguimento<br>
2.1. * Comparar a porcentagem máxima de perda de peso entre seguimento ≤12 meses e &gt;12 meses, ajustando por sexo, etnia, idade, IMC inicial, comorbidades e uso de medicação.<br>
2.2. * Avaliar associação da perda de peso máxima com variáveis demográficas, clínicas e de seguimento.<br>
2.3. * Descrever o momento em que cada indivíduo atingiu ≥5% de perda em relação ao peso inicial.</p></li>
<li><p>Subgrupos com perda ≥5%<br>
3.1. * Identificar o tempo e a consulta da primeira observação de perda ≥5%.<br>
3.2. * Medidas de frequência de reganho de peso após a perda ≥5%.<br>
3.3. * Comparar a perda máxima entre subgrupos (≤6 meses, 6–12 meses, &gt;12 meses).</p></li>
<li><p>Grupo sem perda ≥5%<br>
4.1. * Identificar tempo de seguimento e consulta com maior perda observada.<br>
4.2. * Descrever o ganho de peso após esse momento.</p></li>
<li><p>Protocolos e padronização<br>
5.1. Elaborar protocolo de atendimento com critérios de inclusão, rastreio, seguimento, tratamento e alta.<br>
5.2. Desenvolver ficha médica padronizada para implementação do protocolo.</p></li>
</ol>
</section>
<section id="escolha-do-dataset" class="level2">
<h2 class="anchored" data-anchor-id="escolha-do-dataset">Escolha do dataset</h2>
<p>Escolha o dataset desejado para as análises subsequentes</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>obese <span class="ot">&lt;-</span> consultas_2_visits</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  consultas, </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  consultas_bmi, </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  obese_intersect,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  consultas_adults, </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  consultas_2_visits, </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  consultas_underage, </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  consultas_adults_records, </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  common_record_ids, </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  underage_records)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="componente-descritivo" class="level2">
<h2 class="anchored" data-anchor-id="componente-descritivo">1. Componente descritivo</h2>
<section id="perfil-epidemiológico-na-primeira-consulta-idade-sexo-etnia-imc-comorbidades." class="level3">
<h3 class="anchored" data-anchor-id="perfil-epidemiológico-na-primeira-consulta-idade-sexo-etnia-imc-comorbidades.">1.1. Perfil epidemiológico na primeira consulta: idade, sexo, etnia, IMC, comorbidades.</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Primeira consulta por paciente</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>baseline <span class="ot">&lt;-</span> obese <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(record_id) <span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(date_consultation, <span class="at">.by_group =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Funções auxiliares ----------------------------------------------------</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 2.1) Estatísticas com IC95% (t de Student) + min/max, ignorando NAs</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>ic95_stats <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> x[<span class="sc">!</span><span class="fu">is.na</span>(x)]</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  n  <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (n <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(<span class="at">media =</span> <span class="cn">NA_real_</span>, <span class="at">li =</span> <span class="cn">NA_real_</span>, <span class="at">ls =</span> <span class="cn">NA_real_</span>, <span class="at">min =</span> <span class="cn">NA_real_</span>, <span class="at">max =</span> <span class="cn">NA_real_</span>))</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  m  <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  s  <span class="ot">&lt;-</span> <span class="fu">sd</span>(x)</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  se <span class="ot">&lt;-</span> s <span class="sc">/</span> <span class="fu">sqrt</span>(n)</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  tcrit <span class="ot">&lt;-</span> <span class="cf">if</span> (n <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>) <span class="cf">else</span> <span class="cn">NA_real_</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  li <span class="ot">&lt;-</span> <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.na</span>(tcrit)) m <span class="sc">-</span> tcrit <span class="sc">*</span> se <span class="cf">else</span> <span class="cn">NA_real_</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  ls <span class="ot">&lt;-</span> <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.na</span>(tcrit)) m <span class="sc">+</span> tcrit <span class="sc">*</span> se <span class="cf">else</span> <span class="cn">NA_real_</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="at">media =</span> m, <span class="at">li =</span> li, <span class="at">ls =</span> ls, <span class="at">min =</span> <span class="fu">min</span>(x), <span class="at">max =</span> <span class="fu">max</span>(x))</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="co"># 2.2) Resumo de completude (N missings e %)</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>na_profile <span class="ot">&lt;-</span> <span class="cf">function</span>(v) {</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>  n_total   <span class="ot">&lt;-</span> <span class="fu">length</span>(v)</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>  n_na      <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(v))</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>  pct_na    <span class="ot">&lt;-</span> <span class="cf">if</span> (n_total <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="dv">100</span> <span class="sc">*</span> n_na <span class="sc">/</span> n_total <span class="cf">else</span> <span class="cn">NA_real_</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="at">n_total =</span> n_total, <span class="at">n_na =</span> n_na, <span class="at">pct_na =</span> pct_na)</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) Resumos NUMÉRICOS -----------------------------------------------------</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a><span class="co"># 3.1) Estatísticas com IC95% para variáveis contínuas</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>idade_stats  <span class="ot">&lt;-</span> <span class="fu">ic95_stats</span>(baseline<span class="sc">$</span>age)</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>peso_stats   <span class="ot">&lt;-</span> <span class="fu">ic95_stats</span>(baseline<span class="sc">$</span>weight_kg)</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>altura_stats <span class="ot">&lt;-</span> <span class="fu">ic95_stats</span>(baseline<span class="sc">$</span>height_m)</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>imc_stats    <span class="ot">&lt;-</span> <span class="fu">ic95_stats</span>(baseline<span class="sc">$</span>bmi)</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a><span class="co"># 3.2) Completude para variáveis contínuas</span></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>idade_na  <span class="ot">&lt;-</span> <span class="fu">na_profile</span>(baseline<span class="sc">$</span>age)</span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>peso_na   <span class="ot">&lt;-</span> <span class="fu">na_profile</span>(baseline<span class="sc">$</span>weight_kg)</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>altura_na <span class="ot">&lt;-</span> <span class="fu">na_profile</span>(baseline<span class="sc">$</span>height_m)</span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>imc_na    <span class="ot">&lt;-</span> <span class="fu">na_profile</span>(baseline<span class="sc">$</span>bmi)</span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a><span class="co"># 4) Resumos CATEGÓRICOS ---------------------------------------------------</span></span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Para sex e race, proporções calculadas sobre N não-missing,</span></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a><span class="co"># mas também exibimos N e % de NAs</span></span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a><span class="co"># 4.1) Sexo</span></span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>sexo_baseline <span class="ot">&lt;-</span> baseline <span class="sc">%&gt;%</span></span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sex, <span class="at">name =</span> <span class="st">"n"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> <span class="dv">100</span> <span class="sc">*</span> n <span class="sc">/</span> <span class="fu">sum</span>(n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>sexo_na <span class="ot">&lt;-</span> <span class="fu">na_profile</span>(baseline<span class="sc">$</span>sex)</span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a><span class="co"># 4.2) Etnia</span></span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>etnia_baseline <span class="ot">&lt;-</span> baseline <span class="sc">%&gt;%</span></span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(race, <span class="at">name =</span> <span class="st">"n"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> <span class="dv">100</span> <span class="sc">*</span> n <span class="sc">/</span> <span class="fu">sum</span>(n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a>etnia_na <span class="ot">&lt;-</span> <span class="fu">na_profile</span>(baseline<span class="sc">$</span>race)</span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a><span class="co"># 5) Tibbles consolidados ---------------------------------------------------</span></span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a><span class="co"># 5.1) Perfil numérico (uma linha por variável, com média, IC95, min, max, NAs)</span></span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a>perfil_numerico <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a>  <span class="at">Variavel   =</span> <span class="fu">c</span>(<span class="st">"Idade (anos)"</span>, <span class="st">"Peso (kg)"</span>, <span class="st">"Altura (m)"</span>, <span class="st">"IMC (kg/m²)"</span>),</span>
<span id="cb7-72"><a href="#cb7-72" aria-hidden="true" tabindex="-1"></a>  <span class="at">Media      =</span> <span class="fu">c</span>(idade_stats[<span class="st">"media"</span>],  peso_stats[<span class="st">"media"</span>],  altura_stats[<span class="st">"media"</span>],  imc_stats[<span class="st">"media"</span>]),</span>
<span id="cb7-73"><a href="#cb7-73" aria-hidden="true" tabindex="-1"></a>  <span class="at">IC95_inf   =</span> <span class="fu">c</span>(idade_stats[<span class="st">"li"</span>],     peso_stats[<span class="st">"li"</span>],     altura_stats[<span class="st">"li"</span>],     imc_stats[<span class="st">"li"</span>]),</span>
<span id="cb7-74"><a href="#cb7-74" aria-hidden="true" tabindex="-1"></a>  <span class="at">IC95_sup   =</span> <span class="fu">c</span>(idade_stats[<span class="st">"ls"</span>],     peso_stats[<span class="st">"ls"</span>],     altura_stats[<span class="st">"ls"</span>],     imc_stats[<span class="st">"ls"</span>]),</span>
<span id="cb7-75"><a href="#cb7-75" aria-hidden="true" tabindex="-1"></a>  <span class="at">Minimo     =</span> <span class="fu">c</span>(idade_stats[<span class="st">"min"</span>],    peso_stats[<span class="st">"min"</span>],    altura_stats[<span class="st">"min"</span>],    imc_stats[<span class="st">"min"</span>]),</span>
<span id="cb7-76"><a href="#cb7-76" aria-hidden="true" tabindex="-1"></a>  <span class="at">Maximo     =</span> <span class="fu">c</span>(idade_stats[<span class="st">"max"</span>],    peso_stats[<span class="st">"max"</span>],    altura_stats[<span class="st">"max"</span>],    imc_stats[<span class="st">"max"</span>]),</span>
<span id="cb7-77"><a href="#cb7-77" aria-hidden="true" tabindex="-1"></a>  <span class="at">N_total    =</span> <span class="fu">c</span>(idade_na[<span class="st">"n_total"</span>],   peso_na[<span class="st">"n_total"</span>],   altura_na[<span class="st">"n_total"</span>],   imc_na[<span class="st">"n_total"</span>]),</span>
<span id="cb7-78"><a href="#cb7-78" aria-hidden="true" tabindex="-1"></a>  <span class="at">N_NA       =</span> <span class="fu">c</span>(idade_na[<span class="st">"n_na"</span>],      peso_na[<span class="st">"n_na"</span>],      altura_na[<span class="st">"n_na"</span>],      imc_na[<span class="st">"n_na"</span>]),</span>
<span id="cb7-79"><a href="#cb7-79" aria-hidden="true" tabindex="-1"></a>  <span class="at">Perc_NA    =</span> <span class="fu">c</span>(idade_na[<span class="st">"pct_na"</span>],    peso_na[<span class="st">"pct_na"</span>],    altura_na[<span class="st">"pct_na"</span>],    imc_na[<span class="st">"pct_na"</span>])</span>
<span id="cb7-80"><a href="#cb7-80" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-81"><a href="#cb7-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-82"><a href="#cb7-82" aria-hidden="true" tabindex="-1"></a><span class="co"># 5.2) Perfil categórico (uma linha por categoria + linha de NAs)</span></span>
<span id="cb7-83"><a href="#cb7-83" aria-hidden="true" tabindex="-1"></a>sexo_tbl <span class="ot">&lt;-</span> sexo_baseline <span class="sc">%&gt;%</span></span>
<span id="cb7-84"><a href="#cb7-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Variavel =</span> <span class="st">"Sexo"</span>,</span>
<span id="cb7-85"><a href="#cb7-85" aria-hidden="true" tabindex="-1"></a>         <span class="at">Categoria =</span> <span class="fu">as.character</span>(sex)) <span class="sc">%&gt;%</span></span>
<span id="cb7-86"><a href="#cb7-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Variavel, Categoria, n, prop)</span>
<span id="cb7-87"><a href="#cb7-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-88"><a href="#cb7-88" aria-hidden="true" tabindex="-1"></a>sexo_tbl_na <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb7-89"><a href="#cb7-89" aria-hidden="true" tabindex="-1"></a>  <span class="at">Variavel =</span> <span class="st">"Sexo"</span>,</span>
<span id="cb7-90"><a href="#cb7-90" aria-hidden="true" tabindex="-1"></a>  <span class="at">Categoria =</span> <span class="st">"NA"</span>,</span>
<span id="cb7-91"><a href="#cb7-91" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> sexo_na[<span class="st">"n_na"</span>],</span>
<span id="cb7-92"><a href="#cb7-92" aria-hidden="true" tabindex="-1"></a>  <span class="at">prop =</span> <span class="dv">100</span> <span class="sc">*</span> <span class="fu">as.numeric</span>(sexo_na[<span class="st">"n_na"</span>]) <span class="sc">/</span> <span class="fu">as.numeric</span>(sexo_na[<span class="st">"n_total"</span>])</span>
<span id="cb7-93"><a href="#cb7-93" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-94"><a href="#cb7-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-95"><a href="#cb7-95" aria-hidden="true" tabindex="-1"></a>etnia_tbl <span class="ot">&lt;-</span> etnia_baseline <span class="sc">%&gt;%</span></span>
<span id="cb7-96"><a href="#cb7-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Variavel =</span> <span class="st">"Etnia"</span>,</span>
<span id="cb7-97"><a href="#cb7-97" aria-hidden="true" tabindex="-1"></a>         <span class="at">Categoria =</span> <span class="fu">as.character</span>(race)) <span class="sc">%&gt;%</span></span>
<span id="cb7-98"><a href="#cb7-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Variavel, Categoria, n, prop)</span>
<span id="cb7-99"><a href="#cb7-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-100"><a href="#cb7-100" aria-hidden="true" tabindex="-1"></a>etnia_tbl_na <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb7-101"><a href="#cb7-101" aria-hidden="true" tabindex="-1"></a>  <span class="at">Variavel =</span> <span class="st">"Etnia"</span>,</span>
<span id="cb7-102"><a href="#cb7-102" aria-hidden="true" tabindex="-1"></a>  <span class="at">Categoria =</span> <span class="st">"NA"</span>,</span>
<span id="cb7-103"><a href="#cb7-103" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> etnia_na[<span class="st">"n_na"</span>],</span>
<span id="cb7-104"><a href="#cb7-104" aria-hidden="true" tabindex="-1"></a>  <span class="at">prop =</span> <span class="dv">100</span> <span class="sc">*</span> <span class="fu">as.numeric</span>(etnia_na[<span class="st">"n_na"</span>]) <span class="sc">/</span> <span class="fu">as.numeric</span>(etnia_na[<span class="st">"n_total"</span>])</span>
<span id="cb7-105"><a href="#cb7-105" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-106"><a href="#cb7-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-107"><a href="#cb7-107" aria-hidden="true" tabindex="-1"></a>perfil_categorico <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb7-108"><a href="#cb7-108" aria-hidden="true" tabindex="-1"></a>  sexo_tbl, sexo_tbl_na,</span>
<span id="cb7-109"><a href="#cb7-109" aria-hidden="true" tabindex="-1"></a>  etnia_tbl, etnia_tbl_na</span>
<span id="cb7-110"><a href="#cb7-110" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-111"><a href="#cb7-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-112"><a href="#cb7-112" aria-hidden="true" tabindex="-1"></a><span class="co"># 6) N total de pacientes</span></span>
<span id="cb7-113"><a href="#cb7-113" aria-hidden="true" tabindex="-1"></a>n_total_pacientes <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">n_distinct</span>(baseline<span class="sc">$</span>record_id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>O código está estruturado em blocos que constroem o perfil epidemiológico dos pacientes na primeira consulta:</p>
<ol type="1">
<li><p><strong>Primeira consulta por paciente</strong>: cria o dataframe <code>baseline</code>, contendo apenas a primeira consulta registrada de cada paciente, para servir como referência do perfil inicial.</p></li>
<li><p><strong>Funções auxiliares</strong>:</p>
<ul>
<li><code>ic95_stats</code>: calcula média, intervalo de confiança de 95% (usando t de Student), valor mínimo e máximo de variáveis numéricas.<br>
</li>
<li><code>na_profile</code>: calcula completude das variáveis (total, número e porcentagem de valores ausentes).</li>
</ul></li>
<li><p><strong>Resumos numéricos</strong>: aplica <code>ic95_stats</code> e <code>na_profile</code> às variáveis contínuas (idade, peso, altura e IMC) da primeira consulta, gerando estatísticas descritivas com IC95% e informações de valores ausentes.</p></li>
<li><p><strong>Resumos categóricos</strong>: gera frequências absolutas e relativas para sexo e etnia, além de contabilizar valores ausentes para cada variável categórica.</p></li>
<li><p><strong>Tabelas consolidadas</strong>:</p>
<ul>
<li><code>perfil_numerico</code>: organiza as estatísticas das variáveis contínuas em formato tabular (uma linha por variável).<br>
</li>
<li><code>perfil_categorico</code>: organiza as distribuições de sexo e etnia, incluindo linhas extras para valores ausentes.</li>
</ul></li>
<li><p><strong>Número total de pacientes</strong>: calcula o total de indivíduos distintos na base <code>baseline</code>, fornecendo o tamanho da amostra inicial.</p></li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para formatar com decimais definidos</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>fmt <span class="ot">&lt;-</span> <span class="cf">function</span>(x, dec) {</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>(<span class="fu">is.na</span>(x), <span class="st">""</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>         <span class="fu">format</span>(<span class="fu">round</span>(<span class="fu">as.numeric</span>(x), dec),</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">big.mark =</span> <span class="st">"."</span>, <span class="at">decimal.mark =</span> <span class="st">","</span>, <span class="at">trim =</span> <span class="cn">TRUE</span>))</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Definir número de casas decimais por variável</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>dec_map <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Idade (anos)"</span> <span class="ot">=</span> <span class="dv">0</span>,</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Peso (kg)"</span>    <span class="ot">=</span> <span class="dv">1</span>,</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Altura (m)"</span>   <span class="ot">=</span> <span class="dv">1</span>,</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>             <span class="st">"IMC (kg/m²)"</span>  <span class="ot">=</span> <span class="dv">1</span>)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Aplicar formatação na tabela numérica</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>perfil_numerico_fmt <span class="ot">&lt;-</span> perfil_numerico <span class="sc">%&gt;%</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">d =</span> dec_map[Variavel],</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">Media    =</span> <span class="fu">fmt</span>(Media, d),</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">IC95_inf =</span> <span class="fu">fmt</span>(IC95_inf, d),</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">IC95_sup =</span> <span class="fu">fmt</span>(IC95_sup, d),</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">Minimo   =</span> <span class="fu">fmt</span>(Minimo, d),</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">Maximo   =</span> <span class="fu">fmt</span>(Maximo, d),</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">Perc_NA  =</span> <span class="fu">paste0</span>(<span class="fu">fmt</span>(Perc_NA, <span class="dv">1</span>), <span class="st">"%"</span>)</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>d)</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Renderizar tabela final</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>  perfil_numerico_fmt,</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Variável"</span>,<span class="st">"Média"</span>,<span class="st">"IC95% Inferior"</span>,<span class="st">"IC95% Superior"</span>,<span class="st">"Mínimo"</span>,<span class="st">"Máximo"</span>,<span class="st">"N total"</span>,<span class="st">"N (NA)"</span>,<span class="st">"% (NA)"</span>),</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>,<span class="st">"c"</span>,<span class="st">"c"</span>,<span class="st">"c"</span>,<span class="st">"c"</span>,<span class="st">"c"</span>,<span class="st">"c"</span>,<span class="st">"c"</span>,<span class="st">"c"</span>)</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 13%">
<col style="width: 7%">
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 8%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variável</th>
<th style="text-align: center;">Média</th>
<th style="text-align: center;">IC95% Inferior</th>
<th style="text-align: center;">IC95% Superior</th>
<th style="text-align: center;">Mínimo</th>
<th style="text-align: center;">Máximo</th>
<th style="text-align: center;">N total</th>
<th style="text-align: center;">N (NA)</th>
<th style="text-align: center;">% (NA)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Idade (anos)</td>
<td style="text-align: center;">44</td>
<td style="text-align: center;">43</td>
<td style="text-align: center;">45</td>
<td style="text-align: center;">18</td>
<td style="text-align: center;">84</td>
<td style="text-align: center;">574</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Peso (kg)</td>
<td style="text-align: center;">133,8</td>
<td style="text-align: center;">130,4</td>
<td style="text-align: center;">137,2</td>
<td style="text-align: center;">59,7</td>
<td style="text-align: center;">268,7</td>
<td style="text-align: center;">574</td>
<td style="text-align: center;">99</td>
<td style="text-align: center;">17,2%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Altura (m)</td>
<td style="text-align: center;">1,6</td>
<td style="text-align: center;">1,6</td>
<td style="text-align: center;">1,7</td>
<td style="text-align: center;">1,1</td>
<td style="text-align: center;">1,9</td>
<td style="text-align: center;">574</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">IMC (kg/m²)</td>
<td style="text-align: center;">48,9</td>
<td style="text-align: center;">47,8</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">26,9</td>
<td style="text-align: center;">91,5</td>
<td style="text-align: center;">574</td>
<td style="text-align: center;">99</td>
<td style="text-align: center;">17,2%</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Este código prepara e exibe a tabela formatada das variáveis numéricas do perfil basal:</p>
<ol type="1">
<li><p><strong>Função de formatação (<code>fmt</code>)</strong>: cria um padrão para exibir números com o número de casas decimais definido, usando separador decimal em vírgula e separador de milhar em ponto. Valores ausentes são exibidos como vazio.</p></li>
<li><p><strong>Mapa de decimais (<code>dec_map</code>)</strong>: define quantas casas decimais cada variável deve ter (idade sem casas decimais; peso, altura e IMC com uma casa decimal).</p></li>
<li><p><strong>Aplicação da formatação</strong>: para cada linha da tabela <code>perfil_numerico</code>, aplica o número adequado de casas decimais, formata estatísticas (média, IC95%, mínimo, máximo) e acrescenta o símbolo de porcentagem na coluna de dados ausentes.</p></li>
<li><p><strong>Renderização</strong>: gera a tabela final em formato bem apresentado usando <code>knitr::kable</code>, com nomes de colunas ajustados e alinhamento centralizado para valores numéricos.</p></li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Função de formatação</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>fmt_num <span class="ot">&lt;-</span> <span class="cf">function</span>(x, dec) <span class="fu">format</span>(<span class="fu">round</span>(x, dec), <span class="at">big.mark =</span> <span class="st">"."</span>, <span class="at">decimal.mark =</span> <span class="st">","</span>, <span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Aplicar formatação</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>perfil_categorico_fmt <span class="ot">&lt;-</span> perfil_categorico <span class="sc">%&gt;%</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">n    =</span> <span class="fu">fmt_num</span>(n, <span class="dv">0</span>),   <span class="co"># N total sem casas decimais</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">prop =</span> <span class="fu">fmt_num</span>(prop, <span class="dv">1</span>) <span class="co"># Proporção (%) com 1 casa decimal</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Renderizar tabela</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  perfil_categorico_fmt,</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Variável"</span>, <span class="st">"Categoria"</span>, <span class="st">"N total"</span>, <span class="st">"Proporção (%)"</span>),</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>),</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Perfil categórico: sexo e etnia na primeira consulta"</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Perfil categórico: sexo e etnia na primeira consulta</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Variável</th>
<th style="text-align: left;">Categoria</th>
<th style="text-align: center;">N total</th>
<th style="text-align: center;">Proporção (%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Sexo</td>
<td style="text-align: left;">F</td>
<td style="text-align: center;">375</td>
<td style="text-align: center;">65,3</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sexo</td>
<td style="text-align: left;">M</td>
<td style="text-align: center;">199</td>
<td style="text-align: center;">34,7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sexo</td>
<td style="text-align: left;">NA</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0,0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Etnia</td>
<td style="text-align: left;">Branco</td>
<td style="text-align: center;">428</td>
<td style="text-align: center;">74,6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Etnia</td>
<td style="text-align: left;">Mulato (Pardo)</td>
<td style="text-align: center;">95</td>
<td style="text-align: center;">16,6</td>
</tr>
<tr class="even">
<td style="text-align: left;">Etnia</td>
<td style="text-align: left;">Preto</td>
<td style="text-align: center;">48</td>
<td style="text-align: center;">8,4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Etnia</td>
<td style="text-align: left;">VERIFICAR</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">0,5</td>
</tr>
<tr class="even">
<td style="text-align: left;">Etnia</td>
<td style="text-align: left;">NA</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0,0</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Este código organiza e exibe a tabela formatada das variáveis categóricas do perfil basal:</p>
<ol type="1">
<li><p><strong>Função de formatação (<code>fmt_num</code>)</strong>: define a apresentação numérica com separador decimal em vírgula e separador de milhar em ponto.</p>
<ul>
<li>Contagens (<code>n</code>) são exibidas sem casas decimais.<br>
</li>
<li>Proporções (<code>prop</code>) são exibidas com uma casa decimal.</li>
</ul></li>
<li><p><strong>Aplicação da formatação</strong>: transforma os valores da tabela <code>perfil_categorico</code> para o formato definido, garantindo consistência na apresentação.</p></li>
<li><p><strong>Renderização</strong>: gera a tabela final com <code>knitr::kable</code>, exibindo variáveis, categorias, frequências absolutas e relativas (%), com legenda clara sobre o conteúdo.</p></li>
</ol>
<blockquote class="blockquote">
<p>Interpretação:</p>
</blockquote>
<p>Foram incluídos <strong>574 pacientes</strong> na linha de base.</p>
<p>A idade média foi de <strong>44 anos (IC95%: 43–45)</strong>, variando entre 18 e 84 anos.<br>
O peso médio foi de <strong>133,8 kg (IC95%: 130,4–137,2)</strong>, com mínimo de 59,7 kg e máximo de 268,7 kg.<br>
A altura média foi de <strong>1,65 m (IC95%: 1,64–1,66)</strong>, variando de 1,15 m a 1,91 m.<br>
O IMC médio foi de <strong>48,9 kg/m² (IC95%: 47,8–50,0)</strong>, com valores mínimos e máximos de 26,9 kg/m² e 91,5 kg/m², respectivamente.</p>
<p>Quanto à completude dos dados, não houve valores ausentes para idade e altura. Já para peso e IMC observaram-se <strong>99 casos faltantes (17,2%)</strong>.</p>
<p>Na distribuição por sexo, <strong>375 pacientes (65,3%) eram mulheres</strong> e <strong>199 (34,7%) homens</strong>, sem dados ausentes.<br>
Em relação à etnia, predominou a categoria <strong>Branco (n=428; 74,6%)</strong>, seguida de <strong>Mulato/Pardo (n=95; 16,6%)</strong>, <strong>Preto (n=48; 8,4%)</strong> e casos classificados como <strong>“VERIFICAR” (n=3; 0,5%)</strong>. Não houve valores ausentes registrados.</p>
<p><strong>Resumo interpretativo:</strong> A população atendida na primeira consulta caracteriza-se por indivíduos de meia-idade, com predomínio do sexo feminino, obesidade grave (IMC médio ≈49 kg/m²) e predominância de pacientes brancos. A completude foi satisfatória, com ausência de dados apenas para peso e IMC em cerca de 17% dos casos.</p>
<blockquote class="blockquote">
<p>Resultados: Na primeira consulta foram avaliados <strong>574 pacientes</strong>, com idade média de <strong>44 anos (IC95%: 43–45)</strong>, variando entre 18 e 84 anos. O peso médio foi de <strong>133,8 kg (IC95%: 130,4–137,2)</strong> e a altura média de <strong>1,65 m (IC95%: 1,64–1,66)</strong>, resultando em um <strong>IMC médio de 48,9 kg/m² (IC95%: 47,8–50,0)</strong>. Os valores mínimos e máximos observados foram, respectivamente, 59,7 e 268,7 kg para peso; 1,15 e 1,91 m para altura; e 26,9 e 91,5 kg/m² para IMC. Houve ausência de dados em <strong>17,2%</strong> das observações de peso e IMC. A maioria dos pacientes era do <strong>sexo feminino (65,3%)</strong>, enquanto 34,7% eram do sexo masculino. Quanto à etnia, predominou a categoria <strong>branca (74,6%)</strong>, seguida de <strong>parda (16,6%)</strong>, <strong>preta (8,4%)</strong> e casos classificados como “<strong>verificar</strong>” (0,5%).</p>
</blockquote>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remover apenas objetos intermediários criados durante a análise do item 1.1</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Mantendo as funções auxiliares (ic95_stats, na_profile, fmt, fmt_num)</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#baseline,</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  idade_stats, peso_stats, altura_stats, imc_stats,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  idade_na, peso_na, altura_na, imc_na,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  sexo_baseline, sexo_na,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  etnia_baseline, etnia_na,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  sexo_tbl, sexo_tbl_na,</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  etnia_tbl, etnia_tbl_na,</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  perfil_numerico, </span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  perfil_numerico_fmt,</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  perfil_categorico, </span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  perfil_categorico_fmt,</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>  n_total_pacientes,</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  dec_map</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Este código limpa o ambiente de trabalho removendo apenas os objetos intermediários criados durante a análise do perfil epidemiológico da primeira consulta. Ele mantém disponíveis apenas as funções auxiliares e as tabelas finais formatadas, enquanto descarta estatísticas temporárias, perfis numéricos e categóricos intermediários e o mapa de formatação.</p>
</section>
<section id="indicadores-de-atendimento-número-de-consultas-e-tempo-de-seguimento." class="level3">
<h3 class="anchored" data-anchor-id="indicadores-de-atendimento-número-de-consultas-e-tempo-de-seguimento.">1.3. Indicadores de atendimento: número de consultas e tempo de seguimento.</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calcular número de consultas, tempo de seguimento e tempo médio entre consultas</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>indicadores_atendimento <span class="ot">&lt;-</span> obese <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(record_id) <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_consultas =</span> <span class="fu">n</span>(), <span class="co"># número de consultas por paciente</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># tempo total de seguimento entre a 1ª e a última consulta</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">tempo_seguimento_dias =</span> <span class="fu">as.numeric</span>(<span class="fu">max</span>(date_consultation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">min</span>(date_consultation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">tempo_seguimento_semanas =</span> tempo_seguimento_dias <span class="sc">/</span> <span class="dv">7</span>,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">tempo_seguimento_meses  =</span> tempo_seguimento_dias <span class="sc">/</span> <span class="fl">30.44</span>,</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">tempo_seguimento_anos   =</span> tempo_seguimento_dias <span class="sc">/</span> <span class="fl">365.25</span>,</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># tempo médio entre consultas (média dos intervalos entre visitas consecutivas)</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">tempo_medio_entre_consultas_dias =</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>      n_consultas <span class="sc">&gt;</span> <span class="dv">1</span>,</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>      tempo_seguimento_dias <span class="sc">/</span> (n_consultas <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.numeric</span>(<span class="cn">NA</span>)</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># conversões auxiliares</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">tempo_medio_entre_consultas_semanas =</span> tempo_medio_entre_consultas_dias <span class="sc">/</span> <span class="dv">7</span>,</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">tempo_medio_entre_consultas_meses   =</span> tempo_medio_entre_consultas_dias <span class="sc">/</span> <span class="fl">30.44</span>,</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">tempo_medio_entre_consultas_anos    =</span> tempo_medio_entre_consultas_dias <span class="sc">/</span> <span class="fl">365.25</span>,</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Esse código cria o dataframe <code>indicadores_atendimento</code>, que calcula os principais indicadores de atendimento para cada paciente. Primeiro, obtém o número total de consultas realizadas. Em seguida, calcula o tempo de seguimento, definido como a diferença entre a primeira e a última consulta, e expressa esse intervalo em dias, semanas, meses e anos. Depois, estima o tempo médio entre consultas, que corresponde à média dos intervalos entre visitas consecutivas, também convertido para diferentes unidades de tempo. O resultado é um conjunto de indicadores resumidos por paciente, organizados em uma tabela consolidada.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Medidas solicitadas: mediana, p5, p25, p75, p95, máximo</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>sumario_n_consultas <span class="ot">&lt;-</span> indicadores_atendimento <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">p5      =</span> <span class="fu">quantile</span>(n_consultas, <span class="at">probs =</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">type =</span> <span class="dv">7</span>),</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">p25     =</span> <span class="fu">quantile</span>(n_consultas, <span class="at">probs =</span> <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">type =</span> <span class="dv">7</span>),</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">mediana =</span> <span class="fu">quantile</span>(n_consultas, <span class="at">probs =</span> <span class="fl">0.50</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">type =</span> <span class="dv">7</span>),</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">p75     =</span> <span class="fu">quantile</span>(n_consultas, <span class="at">probs =</span> <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">type =</span> <span class="dv">7</span>),</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">p95     =</span> <span class="fu">quantile</span>(n_consultas, <span class="at">probs =</span> <span class="fl">0.95</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">type =</span> <span class="dv">7</span>),</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">max     =</span> <span class="fu">max</span>(n_consultas, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"medida"</span>, <span class="at">values_to =</span> <span class="st">"valor"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">valor_fmt =</span> <span class="fu">fmt</span>(valor, <span class="at">dec =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(medida, <span class="at">valor =</span> valor_fmt)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(sumario_n_consultas,</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Número de consultas por paciente — mediana, percentis (5, 25, 75, 95) e máximo"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Número de consultas por paciente — mediana, percentis (5, 25, 75, 95) e máximo</caption>
<thead>
<tr class="header">
<th style="text-align: left;">medida</th>
<th style="text-align: left;">valor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">p5</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">p25</td>
<td style="text-align: left;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mediana</td>
<td style="text-align: left;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">p75</td>
<td style="text-align: left;">9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">p95</td>
<td style="text-align: left;">17</td>
</tr>
<tr class="even">
<td style="text-align: left;">max</td>
<td style="text-align: left;">26</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Este código gera um resumo descritivo do número de consultas por paciente. Ele calcula medidas de tendência e dispersão, incluindo os percentis 5, 25, 50 (mediana), 75 e 95, além do valor máximo observado. Os resultados são reorganizados em formato longo, com as medidas e seus valores correspondentes, e formatados sem casas decimais para facilitar a leitura. Por fim, a tabela é exibida com kable, trazendo de forma clara a distribuição do número de consultas na amostra.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribuição de frequências (absoluta e relativa)</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>tabela_frequencias <span class="ot">&lt;-</span> indicadores_atendimento <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(n_consultas, <span class="at">name =</span> <span class="st">"freq"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">pct =</span> <span class="dv">100</span> <span class="sc">*</span> freq <span class="sc">/</span> <span class="fu">sum</span>(freq),</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">freq_fmt =</span> <span class="fu">fmt</span>(freq, <span class="at">dec =</span> <span class="dv">0</span>),</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">pct_fmt  =</span> <span class="fu">paste0</span>(<span class="fu">fmt</span>(pct, <span class="at">dec =</span> <span class="dv">2</span>), <span class="st">"%"</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">`</span><span class="at">n_consultas</span><span class="st">`</span> <span class="ot">=</span> n_consultas,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">frequência</span><span class="st">`</span> <span class="ot">=</span> freq_fmt,</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">%</span><span class="st">`</span> <span class="ot">=</span> pct_fmt)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(tabela_frequencias,</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Distribuição do número de consultas por paciente (frequência e porcentagem)"</span>,</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>      )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Distribuição do número de consultas por paciente (frequência e porcentagem)</caption>
<thead>
<tr class="header">
<th style="text-align: center;">n_consultas</th>
<th style="text-align: center;">frequência</th>
<th style="text-align: center;">%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">2</td>
<td style="text-align: center;">91</td>
<td style="text-align: center;">15,85%</td>
</tr>
<tr class="even">
<td style="text-align: center;">3</td>
<td style="text-align: center;">83</td>
<td style="text-align: center;">14,46%</td>
</tr>
<tr class="odd">
<td style="text-align: center;">4</td>
<td style="text-align: center;">74</td>
<td style="text-align: center;">12,89%</td>
</tr>
<tr class="even">
<td style="text-align: center;">5</td>
<td style="text-align: center;">52</td>
<td style="text-align: center;">9,06%</td>
</tr>
<tr class="odd">
<td style="text-align: center;">6</td>
<td style="text-align: center;">37</td>
<td style="text-align: center;">6,45%</td>
</tr>
<tr class="even">
<td style="text-align: center;">7</td>
<td style="text-align: center;">45</td>
<td style="text-align: center;">7,84%</td>
</tr>
<tr class="odd">
<td style="text-align: center;">8</td>
<td style="text-align: center;">35</td>
<td style="text-align: center;">6,10%</td>
</tr>
<tr class="even">
<td style="text-align: center;">9</td>
<td style="text-align: center;">24</td>
<td style="text-align: center;">4,18%</td>
</tr>
<tr class="odd">
<td style="text-align: center;">10</td>
<td style="text-align: center;">28</td>
<td style="text-align: center;">4,88%</td>
</tr>
<tr class="even">
<td style="text-align: center;">11</td>
<td style="text-align: center;">19</td>
<td style="text-align: center;">3,31%</td>
</tr>
<tr class="odd">
<td style="text-align: center;">12</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">1,39%</td>
</tr>
<tr class="even">
<td style="text-align: center;">13</td>
<td style="text-align: center;">15</td>
<td style="text-align: center;">2,61%</td>
</tr>
<tr class="odd">
<td style="text-align: center;">14</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">2,44%</td>
</tr>
<tr class="even">
<td style="text-align: center;">15</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">1,05%</td>
</tr>
<tr class="odd">
<td style="text-align: center;">16</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">0,87%</td>
</tr>
<tr class="even">
<td style="text-align: center;">17</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">1,57%</td>
</tr>
<tr class="odd">
<td style="text-align: center;">18</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">0,87%</td>
</tr>
<tr class="even">
<td style="text-align: center;">19</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">0,87%</td>
</tr>
<tr class="odd">
<td style="text-align: center;">20</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">0,35%</td>
</tr>
<tr class="even">
<td style="text-align: center;">21</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">0,70%</td>
</tr>
<tr class="odd">
<td style="text-align: center;">22</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">1,05%</td>
</tr>
<tr class="even">
<td style="text-align: center;">23</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">0,52%</td>
</tr>
<tr class="odd">
<td style="text-align: center;">24</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">0,35%</td>
</tr>
<tr class="even">
<td style="text-align: center;">26</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">0,35%</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Este código constrói a distribuição de frequências do número de consultas por paciente. Ele conta quantos indivíduos tiveram exatamente determinado número de consultas, calcula a porcentagem correspondente em relação ao total, e formata os valores para exibição. Por fim, gera uma tabela com três colunas — número de consultas, frequência absoluta e porcentagem — apresentada de forma organizada com kable.</p>
<blockquote class="blockquote">
<p>Resultado: O número de consultas por paciente apresentou ampla variação, oscilando entre 2 e 26 atendimentos durante o período de seguimento. A distribuição mostrou-se assimétrica à direita, com maior concentração nas faixas iniciais: 25% dos pacientes realizaram até 3 consultas, enquanto a mediana foi de 5 consultas e 75% tiveram até 9 consultas. Apenas 5% ultrapassaram 17 atendimentos, caracterizando um grupo minoritário submetido a acompanhamento mais frequente. A tabela de frequências indica que a distribuição é assimétrica à direita: a maioria concentrou-se entre 2 e 9 consultas (cerca de 75% do total), enquanto poucos pacientes atingiram números elevados de atendimentos (acima de 20 consultas, menos de 3%). O gráfico de distribuição acumulada (ECDF) ilustra de forma clara essa tendência, evidenciando que metade dos pacientes foi acompanhada com até cinco consultas e que a curva se estabiliza progressivamente a partir de 10 atendimentos, indicando que casos de seguimento prolongado foram menos comuns.</p>
</blockquote>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(indicadores_atendimento, <span class="fu">aes</span>(<span class="at">x =</span> n_consultas)) <span class="sc">+</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_ecdf</span>(<span class="at">geom =</span> <span class="st">"step"</span>) <span class="sc">+</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(indicadores_atendimento<span class="sc">$</span>n_consultas), <span class="at">by =</span> <span class="dv">1</span>) <span class="co"># ticks a cada 1</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.1</span>), <span class="co"># ticks a cada 10%</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>(<span class="at">accuracy =</span> <span class="dv">1</span>)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Número de consultas por paciente"</span>, <span class="at">y =</span> <span class="st">"Acumulado (%)"</span>) <span class="sc">+</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey80"</span>, <span class="at">linewidth =</span> <span class="fl">0.3</span>), <span class="co"># linhas horizontais principais</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.y =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey90"</span>, <span class="at">linewidth =</span> <span class="fl">0.1</span>), <span class="co"># linhas horizontais menores</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey90"</span>, <span class="at">linewidth =</span> <span class="fl">0.3</span>)  <span class="co"># linhas verticais discretas</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="outputs/figs/n-consultas-ecdf-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Função de distribuição acumulada (ECDF) do número de consultas</figcaption>
</figure>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Legenda O gráfico ECDF mostra no eixo X o número de consultas por paciente e no eixo Y a proporção acumulada de pacientes que atingiram até aquele valor. Observa-se que cerca de <strong>30% dos pacientes tiveram até 3 consultas</strong>, aproximadamente <strong>50% até 5 consultas (mediana)</strong>, e <strong>75% até 9 consultas (percentil 75)</strong>. A curva se aproxima de 100% em torno de 26 consultas, que é o valor máximo observado. Esse tipo de gráfico facilita a visualização dos <strong>percentis</strong>: basta projetar horizontalmente a linha desejada (25%, 50%, 75%, etc.) até interceptar a curva e ler no eixo X o valor correspondente de consultas.</p>
</blockquote>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>resumo_tempo_seguimento <span class="ot">&lt;-</span> indicadores_atendimento <span class="sc">%&gt;%</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">dias_mediana    =</span> <span class="fu">median</span>(tempo_seguimento_dias, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">dias_IQR        =</span> <span class="fu">IQR</span>(tempo_seguimento_dias, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">dias_max        =</span> <span class="fu">max</span>(tempo_seguimento_dias, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">semanas_mediana =</span> <span class="fu">median</span>(tempo_seguimento_semanas, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">semanas_IQR     =</span> <span class="fu">IQR</span>(tempo_seguimento_semanas, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">semanas_max     =</span> <span class="fu">max</span>(tempo_seguimento_semanas, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">meses_mediana   =</span> <span class="fu">median</span>(tempo_seguimento_meses, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">meses_IQR       =</span> <span class="fu">IQR</span>(tempo_seguimento_meses, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">meses_max       =</span> <span class="fu">max</span>(tempo_seguimento_meses, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">anos_mediana    =</span> <span class="fu">median</span>(tempo_seguimento_anos, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">anos_IQR        =</span> <span class="fu">IQR</span>(tempo_seguimento_anos, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">anos_max        =</span> <span class="fu">max</span>(tempo_seguimento_anos, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">everything</span>(),</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"tempo"</span>, <span class="st">"estatistica"</span>),</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_sep =</span> <span class="st">"_"</span>,</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"valor"</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> estatistica,</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> valor</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># aplicar a função fmt com 2 casas decimais</span></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(mediana, IQR, max), <span class="sc">~</span><span class="fu">fmt</span>(.x, <span class="at">dec =</span> <span class="dv">1</span>)))</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(resumo_tempo_seguimento,</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Tempo de seguimento em dias, semanas, meses e anos (mediana, IQR, máximo)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Tempo de seguimento em dias, semanas, meses e anos (mediana, IQR, máximo)</caption>
<thead>
<tr class="header">
<th style="text-align: left;">tempo</th>
<th style="text-align: left;">mediana</th>
<th style="text-align: left;">IQR</th>
<th style="text-align: left;">max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">dias</td>
<td style="text-align: left;">563,5</td>
<td style="text-align: left;">971,2</td>
<td style="text-align: left;">2.800,0</td>
</tr>
<tr class="even">
<td style="text-align: left;">semanas</td>
<td style="text-align: left;">80,5</td>
<td style="text-align: left;">138,8</td>
<td style="text-align: left;">400,0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">meses</td>
<td style="text-align: left;">18,5</td>
<td style="text-align: left;">31,9</td>
<td style="text-align: left;">92,0</td>
</tr>
<tr class="even">
<td style="text-align: left;">anos</td>
<td style="text-align: left;">1,5</td>
<td style="text-align: left;">2,7</td>
<td style="text-align: left;">7,7</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Este código gera um resumo estatístico do tempo de seguimento dos pacientes. Ele calcula, em diferentes unidades de tempo (dias, semanas, meses e anos), a mediana, o intervalo interquartílico (IQR) e o valor máximo do período entre a primeira e a última consulta. Em seguida, reorganiza os resultados em formato de tabela longa e depois larga, aplica formatação numérica com uma casa decimal, e apresenta a tabela final com kable, facilitando a interpretação dos dados de seguimento.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabela com as estatísticas dos TEMPOS MÉDIOS entre consultas</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>resumo_intervalos_consultas <span class="ot">&lt;-</span> indicadores_atendimento <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">dias_mediana    =</span> <span class="fu">median</span>(tempo_medio_entre_consultas_dias, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">dias_IQR        =</span> <span class="fu">IQR</span>(tempo_medio_entre_consultas_dias, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">dias_max        =</span> <span class="fu">max</span>(tempo_medio_entre_consultas_dias, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">semanas_mediana =</span> <span class="fu">median</span>(tempo_medio_entre_consultas_semanas, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">semanas_IQR     =</span> <span class="fu">IQR</span>(tempo_medio_entre_consultas_semanas, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">semanas_max     =</span> <span class="fu">max</span>(tempo_medio_entre_consultas_semanas, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">meses_mediana   =</span> <span class="fu">median</span>(tempo_medio_entre_consultas_meses, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">meses_IQR       =</span> <span class="fu">IQR</span>(tempo_medio_entre_consultas_meses, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">meses_max       =</span> <span class="fu">max</span>(tempo_medio_entre_consultas_meses, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">anos_mediana    =</span> <span class="fu">median</span>(tempo_medio_entre_consultas_anos, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">anos_IQR        =</span> <span class="fu">IQR</span>(tempo_medio_entre_consultas_anos, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">anos_max        =</span> <span class="fu">max</span>(tempo_medio_entre_consultas_anos, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">everything</span>(),</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"tempo"</span>, <span class="st">"estatistica"</span>),</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_sep =</span> <span class="st">"_"</span>,</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"valor"</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> estatistica,</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> valor</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># formatação com vírgula e 2 casas decimais usando sua função `fmt`</span></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(mediana, IQR, max), <span class="sc">~</span> <span class="fu">fmt</span>(.x, <span class="at">dec =</span> <span class="dv">2</span>)))</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(</span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>  resumo_intervalos_consultas,</span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Tempo médio entre consultas em dias, semanas, meses e anos (mediana, IQR, máximo)"</span></span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Tempo médio entre consultas em dias, semanas, meses e anos (mediana, IQR, máximo)</caption>
<thead>
<tr class="header">
<th style="text-align: left;">tempo</th>
<th style="text-align: left;">mediana</th>
<th style="text-align: left;">IQR</th>
<th style="text-align: left;">max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">dias</td>
<td style="text-align: left;">120,68</td>
<td style="text-align: left;">68,78</td>
<td style="text-align: left;">777,00</td>
</tr>
<tr class="even">
<td style="text-align: left;">semanas</td>
<td style="text-align: left;">17,24</td>
<td style="text-align: left;">9,82</td>
<td style="text-align: left;">111,00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">meses</td>
<td style="text-align: left;">3,96</td>
<td style="text-align: left;">2,26</td>
<td style="text-align: left;">25,53</td>
</tr>
<tr class="even">
<td style="text-align: left;">anos</td>
<td style="text-align: left;">0,33</td>
<td style="text-align: left;">0,19</td>
<td style="text-align: left;">2,13</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Este código resume o tempo médio entre consultas dos pacientes. Ele calcula, em dias, semanas, meses e anos, as medidas de posição e dispersão: mediana, intervalo interquartílico (IQR) e valor máximo. Depois, reorganiza os resultados em formato de tabela, aplica a formatação numérica com duas casas decimais e apresenta a saída final de forma organizada com kable, permitindo visualizar claramente os intervalos médios entre as consultas.</p>
<blockquote class="blockquote">
<p>Resultado: O tempo de seguimento dos pacientes apresentou grande amplitude, variando de algumas semanas a mais de 7 anos. A mediana foi de <strong>18,5 meses</strong> (IQR: 31,9), equivalente a <strong>1,5 anos</strong> (IQR: 2,7), com máximo de <strong>7,7 anos</strong> de acompanhamento. Esse resultado indica que metade dos pacientes foi acompanhada por até um ano e meio, enquanto uma parcela menor permaneceu em seguimento prolongado por vários anos.<br>
O intervalo médio entre consultas também variou substancialmente. A mediana foi de aproximadamente <strong>120 dias</strong> (IQR: 68,8), o que corresponde a cerca de <strong>4 meses</strong> entre atendimentos. O percentil superior mostra que alguns pacientes chegaram a intervalos médios de até <strong>777 dias</strong> (mais de 2 anos) entre consultas, sugerindo padrões heterogêneos de acompanhamento.<br>
Em conjunto, esses achados mostram que a maioria dos pacientes foi acompanhada em intervalos regulares de poucos meses, porém com expressiva variação tanto na duração total do seguimento quanto na frequência dos atendimentos.</p>
</blockquote>
<blockquote class="blockquote">
<p>Resultado (versão curta): O tempo de seguimento variou amplamente, com mediana de 1,5 anos e máximo de 7,7 anos. O intervalo médio entre consultas foi de aproximadamente 4 meses (mediana: 120 dias), mas com grande heterogeneidade entre os pacientes. O gráfico de dispersão mostra que, embora a maioria mantenha retornos regulares em intervalos de até 6 meses, em seguimentos mais longos surgem casos com espaçamento progressivamente maior entre consultas, alcançando mais de um ano.</p>
</blockquote>
<blockquote class="blockquote">
<p>Discussão: Os achados referentes ao tempo de seguimento e ao intervalo médio entre consultas sugerem um padrão heterogêneo de acompanhamento. A maioria dos pacientes manteve retornos em intervalos regulares de 3 a 6 meses, consistentes com a prática clínica de monitoramento contínuo em programas de tratamento da obesidade. Entretanto, nos casos de seguimento mais longo observou-se um aumento progressivo na variabilidade, incluindo pacientes com intervalos superiores a 12 meses entre consultas. Esse comportamento pode refletir múltiplos fatores: melhora clínica inicial que reduziu a necessidade de acompanhamento frequente; dificuldades logísticas de comparecimento, como barreiras de acesso e disponibilidade de serviços; ou ainda abandono parcial do acompanhamento formal, com manutenção apenas de retornos ocasionais.<br>
A presença desses dois perfis distintos — pacientes com consultas regulares e outros com retornos esparsos ao longo do tempo — tem implicações metodológicas e clínicas. Do ponto de vista analítico, sugere cautela na interpretação das trajetórias de peso, já que o espaçamento desigual pode introduzir vieses na avaliação da evolução longitudinal. Do ponto de vista clínico, evidencia a importância de estratégias que promovam maior adesão ao acompanhamento, sobretudo em seguimentos prolongados, para garantir a continuidade do cuidado e a detecção precoce de complicações associadas à obesidade.</p>
</blockquote>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(indicadores_atendimento,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> tempo_seguimento_anos,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> tempo_medio_entre_consultas_meses)) <span class="sc">+</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(indicadores_atendimento<span class="sc">$</span>tempo_seguimento_anos, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">by =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(indicadores_atendimento<span class="sc">$</span>tempo_medio_entre_consultas_meses, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">by =</span> <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Tempo de seguimento (anos)"</span>,</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Tempo médio entre consultas (meses)"</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="outputs/figs/seguimento-vs-intervalo-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Relação entre tempo total de seguimento e intervalo médio entre consultas</figcaption>
</figure>
</div>
</div>
</div>
<p>Este código gera um gráfico de dispersão para explorar a relação entre o tempo total de seguimento dos pacientes (em anos) e o intervalo médio entre consultas (em meses). Cada ponto representa um paciente, com transparência aplicada para reduzir sobreposição. Além disso, é ajustada uma linha de regressão linear com intervalo de confiança, destacada em azul, para indicar a tendência da associação entre as duas variáveis. Os eixos são configurados com quebras regulares para facilitar a leitura, e a apresentação utiliza o tema minimalista para manter o gráfico limpo e claro.</p>
<blockquote class="blockquote">
<p>Legenda Figura X. Relação entre o tempo total de seguimento (anos) e o intervalo médio entre consultas (meses). Cada ponto representa um paciente; a linha azul indica a tendência linear. Observa-se que, embora a maioria mantenha intervalos regulares de até 6 meses, em seguimentos prolongados surgem casos com retornos mais espaçados, chegando a mais de um ano. O gráfico de dispersão mostra a relação entre o <strong>tempo total de seguimento</strong> (eixo X, em anos) e o <strong>intervalo médio entre consultas</strong> (eixo Y, em meses) para cada paciente. Cada ponto representa um indivíduo, e a linha azul corresponde à tendência linear ajustada.</p>
</blockquote>
<p>Observa-se que a maioria dos pacientes apresenta <strong>intervalos médios entre consultas de 2 a 6 meses</strong>, independentemente da duração total do seguimento. Contudo, conforme o tempo de acompanhamento aumenta, surgem pacientes com intervalos progressivamente maiores, alguns ultrapassando <strong>12 meses</strong> e chegando a mais de <strong>20 meses</strong> entre consultas em média. Isso explica a discreta inclinação positiva da linha de tendência: em média, pacientes com seguimento mais longo tendem a apresentar <strong>consultas mais espaçadas</strong>.</p>
<p>O padrão sugere dois grupos distintos:<br>
1. <strong>Seguimento curto a intermediário (até 2 anos)</strong> — caracterizado por alta densidade de pontos e intervalos médios regulares, geralmente abaixo de 6 meses.<br>
2. <strong>Seguimento prolongado (acima de 3–4 anos)</strong> — inclui pacientes com <strong>intervalos heterogêneos</strong>, variando de intervalo de seguimento regular até casos com retornos muito espaçados (&gt;1 ano).</p>
<p>Esse achado reforça que, embora a mediana global seja de aproximadamente <strong>4 meses entre consultas</strong>, há <strong>grande heterogeneidade individual</strong>, especialmente entre pacientes mantidos em seguimento por períodos mais longos.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#indicadores_atendimento,</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  sumario_n_consultas,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  tabela_frequencias,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  resumo_tempo_seguimento,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  resumo_intervalos_consultas</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Limpa apenas os objetos intermediários criados durante a análise do item 1.3</p>
</section>
<section id="proporção-de-indivíduos-com-peso-final-maior-que-o-inicial." class="level3">
<h3 class="anchored" data-anchor-id="proporção-de-indivíduos-com-peso-final-maior-que-o-inicial.">1.6. Proporção de indivíduos com peso final maior que o inicial.</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Selecionar primeiro e último peso por paciente</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>peso_inicial_final <span class="ot">&lt;-</span> obese <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(record_id) <span class="sc">%&gt;%</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">peso_inicial =</span> <span class="fu">first</span>(weight_kg[<span class="fu">order</span>(date_consultation)]),</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">peso_final   =</span> <span class="fu">last</span>(weight_kg[<span class="fu">order</span>(date_consultation)]),</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ganhou_peso =</span> peso_final <span class="sc">&gt;</span> peso_inicial)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular proporção e IC95%</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>resultado_peso_final <span class="ot">&lt;-</span> peso_inicial_final <span class="sc">%&gt;%</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_total =</span> <span class="fu">n</span>(),</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_ganho =</span> <span class="fu">sum</span>(ganhou_peso, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">prop_ganho =</span> n_ganho <span class="sc">/</span> n_total</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">ic95 =</span> <span class="fu">list</span>(<span class="fu">binom.test</span>(n_ganho, n_total)<span class="sc">$</span>conf.int)</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest_wider</span>(ic95, <span class="at">names_sep =</span> <span class="st">"_"</span>)</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>resultado_peso_final</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 5
  n_total n_ganho prop_ganho ic95_1 ic95_2
    &lt;int&gt;   &lt;int&gt;      &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1     574     153      0.267  0.231  0.305</code></pre>
</div>
</div>
<p>Esse código seleciona o primeiro e o último peso de cada paciente, compara-os e gera uma variável booleana (ganhou_peso), que assume valor 1 (TRUE) quando o peso da última consulta foi maior que o peso da primeira consulta. Em seguida, calcula-se a proporção de indivíduos cujo peso final foi maior que o inicial, incluindo o intervalo de confiança de 95% (IC95%) pelo teste binomial exato. O resultado mostra o número total de pacientes avaliados, quantos ganharam peso no período e a proporção correspondente, acompanhada do IC95%.</p>
<blockquote class="blockquote">
<p>Resultado Entre os <em>574</em> indivíduos acompanhados, <strong>153 (26,7%; IC95%: 23,1–30,5%) apresentaram peso final maior do que o peso inicial</strong>. Isso indica que aproximadamente um quarto dos pacientes teve ganho ponderal ao longo do período de seguimento, enquanto a maioria (73.3%) apresentou peso final igual ou inferior ao inicial.</p>
</blockquote>
<blockquote class="blockquote">
<p>Discussão Do ponto de vista clínico, esse achado sugere que, embora a maior parte dos pacientes tenha conseguido manter ou reduzir o peso em relação ao início do acompanhamento, ainda existe uma proporção considerável que apresentou reganho ponderal. Esse fenômeno é consistente com a literatura, que aponta a dificuldade de manutenção da perda de peso em longo prazo, especialmente em contextos de obesidade, e reforça a importância de estratégias de acompanhamento contínuo e intervenções sustentadas para prevenção do reganho.</p>
</blockquote>
</section>
<section id="proporção-de-consultas-a-partir-da-segunda-com-ganho-ou-perda-de-peso-em-relação-à-anteriorbaseline." class="level3">
<h3 class="anchored" data-anchor-id="proporção-de-consultas-a-partir-da-segunda-com-ganho-ou-perda-de-peso-em-relação-à-anteriorbaseline.">1.7. Proporção de consultas (a partir da segunda) com ganho ou perda de peso em relação à anterior/baseline.</h3>
<p>Faremos duas análises para responder a perguntas diferentes:</p>
<ol type="1">
<li><strong>Em relação à consulta anterior</strong>
<ul>
<li>Mostra a <strong>trajetória passo a passo</strong>, ou seja, se o paciente está ganhando ou perdendo peso a cada intervalo entre consultas.<br>
</li>
<li>Interessante para avaliar <strong>flutuações</strong> e estabilidade do peso ao longo do seguimento.<br>
</li>
<li>Mais sensível a pequenas variações (até ruído de medida).</li>
</ul></li>
<li><strong>Em relação à primeira consulta</strong>
<ul>
<li>Mostra a <strong>tendência acumulada</strong> desde o início do acompanhamento.<br>
</li>
<li>Interessante para avaliar <strong>manutenção de perda/ganho</strong> ou se houve reversão em algum ponto.<br>
</li>
<li>Mais robusto e fácil de interpretar em termos clínicos (baseline como referência).</li>
</ul></li>
</ol>
<p>Em geral, se o objetivo é <strong>descrever a dinâmica do acompanhamento</strong>, a comparação com a <strong>consulta anterior</strong> (#1) costuma ser mais informativa, pois mostra o comportamento longitudinal. Mas se o foco for <strong>avaliar o impacto do acompanhamento em relação ao estado inicial</strong>, a comparação com a <strong>primeira consulta</strong> (#2) é mais clara e útil para comunicar resultados.</p>
<p><strong>Como interpretar e escolher o que reportar:</strong><br>
- <strong>Versus consulta anterior:</strong> útil para descrever a <strong>dinâmica entre visitas</strong>, sensível a flutuações; ideal para “trajetória” do cuidado.<br>
- <strong>Versus baseline:</strong> comunica a <strong>tendência acumulada</strong> desde o início; costuma ser mais estável e clinicamente intuitiva.</p>
<p>Se o artigo tiver espaço, recomendo <strong>reportar ambos</strong> (principal = baseline; secundário = anterior), pois oferecem perspectivas complementares. Caso precise enxugar, priorize a definição que melhor se alinha ao objetivo do capítulo: <strong>efeito do seguimento</strong> (baseline) vs <strong>padrão de flutuação</strong> (anterior).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparação: função auxiliar de IC95% para proporção</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>ci_prop <span class="ot">&lt;-</span> <span class="cf">function</span>(x, n, <span class="at">conf.level =</span> <span class="fl">0.95</span>) {</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># x = sucessos; n = total</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.na</span>(x) <span class="sc">||</span> <span class="fu">is.na</span>(n) <span class="sc">||</span> n <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">tibble</span>(<span class="at">prop =</span> <span class="cn">NA_real_</span>, <span class="at">lcl =</span> <span class="cn">NA_real_</span>, <span class="at">ucl =</span> <span class="cn">NA_real_</span>))</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  pt <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">prop.test</span>(<span class="at">x =</span> x, <span class="at">n =</span> n, <span class="at">conf.level =</span> conf.level, <span class="at">correct =</span> <span class="cn">FALSE</span>)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">prop =</span> <span class="fu">unname</span>(pt<span class="sc">$</span>estimate),</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">lcl  =</span> <span class="fu">unname</span>(pt<span class="sc">$</span>conf.int[<span class="dv">1</span>]),</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">ucl  =</span> <span class="fu">unname</span>(pt<span class="sc">$</span>conf.int[<span class="dv">2</span>])</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Este chunk define <code>ci_prop()</code>, que calcula proporções com IC95% (teste de proporções com correção de continuidade desabilitada, aproximando o intervalo de Wilson).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Ordenar consultas dentro de cada paciente</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Criar deltas e direções vs consulta anterior e vs baseline</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) Manter apenas consultas a partir da 2ª, com peso observado</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>obese_ord <span class="ot">&lt;-</span> obese <span class="sc">%&gt;%</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(record_id, index, date_consultation) <span class="sc">%&gt;%</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(record_id) <span class="sc">%&gt;%</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># vs consulta anterior</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">weight_prev   =</span> dplyr<span class="sc">::</span><span class="fu">lag</span>(weight_kg),</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">delta_prev_kg =</span> <span class="fu">if_else</span>(<span class="sc">!</span><span class="fu">is.na</span>(weight_kg) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(weight_prev),</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>                            weight_kg <span class="sc">-</span> weight_prev, <span class="cn">NA_real_</span>),</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">dir_prev =</span> <span class="fu">case_when</span>(</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">is.na</span>(delta_prev_kg)         <span class="sc">~</span> <span class="cn">NA_character_</span>,</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>      delta_prev_kg <span class="sc">&gt;</span> <span class="dv">0</span>            <span class="sc">~</span> <span class="st">"ganho"</span>,</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>      delta_prev_kg <span class="sc">&lt;</span> <span class="dv">0</span>            <span class="sc">~</span> <span class="st">"perda"</span>,</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>      delta_prev_kg <span class="sc">==</span> <span class="dv">0</span>           <span class="sc">~</span> <span class="st">"estável"</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># vs baseline (utiliza baseline_weight fornecido no dataset)</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">delta_base_kg =</span> <span class="fu">if_else</span>(<span class="sc">!</span><span class="fu">is.na</span>(weight_kg) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(baseline_weight),</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>                            weight_kg <span class="sc">-</span> baseline_weight, <span class="cn">NA_real_</span>),</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">dir_base =</span> <span class="fu">case_when</span>(</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">is.na</span>(delta_base_kg)         <span class="sc">~</span> <span class="cn">NA_character_</span>,</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>      delta_base_kg <span class="sc">&gt;</span> <span class="dv">0</span>            <span class="sc">~</span> <span class="st">"ganho"</span>,</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>      delta_base_kg <span class="sc">&lt;</span> <span class="dv">0</span>            <span class="sc">~</span> <span class="st">"perda"</span>,</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>      delta_base_kg <span class="sc">==</span> <span class="dv">0</span>           <span class="sc">~</span> <span class="st">"estável"</span></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Elegibilidade: consultas a partir da segunda e com comparador válido</span></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a> eleg_prev <span class="ot">&lt;-</span> obese_ord <span class="sc">%&gt;%</span></span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(index <span class="sc">&gt;=</span> <span class="dv">2</span>, <span class="sc">!</span><span class="fu">is.na</span>(delta_prev_kg), <span class="sc">!</span><span class="fu">is.na</span>(dir_prev))</span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a> eleg_base <span class="ot">&lt;-</span> obese_ord <span class="sc">%&gt;%</span></span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(index <span class="sc">&gt;=</span> <span class="dv">2</span>, <span class="sc">!</span><span class="fu">is.na</span>(delta_base_kg), <span class="sc">!</span><span class="fu">is.na</span>(dir_base))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Aqui organizamos o banco por paciente e consulta, criamos as diferenças de peso em kg vs a consulta anterior e vs a baseline, rotulando cada consulta (≥2ª) como “ganho”, “perda” ou “estável”. Geramos dois subconjuntos elegíveis: <code>eleg_prev</code> (comparação com a anterior) e <code>eleg_base</code> (comparação com a baseline).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para sumarizar proporções por direção (ganho/perda/estável)</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Ela calcula os ICs com `ci_prop()` e faz `bind_cols()` de forma explícita.</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>sumarizar_proporcoes <span class="ot">&lt;-</span> <span class="cf">function</span>(df, dir_col) {</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 1) Contagens básicas</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  base <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">total_consultas =</span> dplyr<span class="sc">::</span><span class="fu">n</span>(),</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">n_ganho   =</span> <span class="fu">sum</span>(.data[[dir_col]] <span class="sc">==</span> <span class="st">"ganho"</span>,   <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">n_perda   =</span> <span class="fu">sum</span>(.data[[dir_col]] <span class="sc">==</span> <span class="st">"perda"</span>,   <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">n_estavel =</span> <span class="fu">sum</span>(.data[[dir_col]] <span class="sc">==</span> <span class="st">"estável"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2) IC95% por direção (devolve data.frames 1x3)</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>  ci_g <span class="ot">&lt;-</span> <span class="fu">ci_prop</span>(base<span class="sc">$</span>n_ganho,   base<span class="sc">$</span>total_consultas) <span class="sc">%&gt;%</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">prop_ganho =</span> prop, <span class="at">lcl_ganho =</span> lcl, <span class="at">ucl_ganho =</span> ucl)</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>  ci_p <span class="ot">&lt;-</span> <span class="fu">ci_prop</span>(base<span class="sc">$</span>n_perda,   base<span class="sc">$</span>total_consultas) <span class="sc">%&gt;%</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">prop_perda =</span> prop, <span class="at">lcl_perda =</span> lcl, <span class="at">ucl_perda =</span> ucl)</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>  ci_e <span class="ot">&lt;-</span> <span class="fu">ci_prop</span>(base<span class="sc">$</span>n_estavel, base<span class="sc">$</span>total_consultas) <span class="sc">%&gt;%</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">prop_estavel =</span> prop, <span class="at">lcl_estavel =</span> lcl, <span class="at">ucl_estavel =</span> ucl)</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 3) Juntar tudo de forma determinística</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(base, ci_g, ci_p, ci_e) <span class="sc">%&gt;%</span></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">prop_ganho_pct   =</span> scales<span class="sc">::</span><span class="fu">percent</span>(prop_ganho,   <span class="at">accuracy =</span> <span class="fl">0.1</span>),</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">prop_perda_pct   =</span> scales<span class="sc">::</span><span class="fu">percent</span>(prop_perda,   <span class="at">accuracy =</span> <span class="fl">0.1</span>),</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">prop_estavel_pct =</span> scales<span class="sc">::</span><span class="fu">percent</span>(prop_estavel, <span class="at">accuracy =</span> <span class="fl">0.1</span>),</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">ic_ganho   =</span> <span class="fu">sprintf</span>(<span class="st">"ganho (%.1f%%; IC95%% %.1f%%–%.1f%%)"</span>,</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>                           <span class="dv">100</span><span class="sc">*</span>prop_ganho, <span class="dv">100</span><span class="sc">*</span>lcl_ganho, <span class="dv">100</span><span class="sc">*</span>ucl_ganho),</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">ic_perda   =</span> <span class="fu">sprintf</span>(<span class="st">"perda (%.1f%%; IC95%% %.1f%%–%.1f%%)"</span>,</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>                           <span class="dv">100</span><span class="sc">*</span>prop_perda, <span class="dv">100</span><span class="sc">*</span>lcl_perda, <span class="dv">100</span><span class="sc">*</span>ucl_perda),</span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">ic_estavel =</span> <span class="fu">sprintf</span>(<span class="st">"estável (%.1f%%; IC95%% %.1f%%–%.1f%%)"</span>,</span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>                           <span class="dv">100</span><span class="sc">*</span>prop_estavel, <span class="dv">100</span><span class="sc">*</span>lcl_estavel, <span class="dv">100</span><span class="sc">*</span>ucl_estavel)</span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>      total_consultas,</span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>      n_ganho, n_perda, n_estavel,</span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>      prop_ganho_pct, prop_perda_pct, prop_estavel_pct,</span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a>      ic_ganho, ic_perda, ic_estavel</span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a>  out</span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Proporções vs consulta anterior</span></span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a>res_prev <span class="ot">&lt;-</span> <span class="fu">sumarizar_proporcoes</span>(eleg_prev, <span class="st">"dir_prev"</span>)</span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Proporções vs baseline</span></span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a>res_base <span class="ot">&lt;-</span> <span class="fu">sumarizar_proporcoes</span>(eleg_base, <span class="st">"dir_base"</span>)</span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a>res_prev</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 10
  total_consultas n_ganho n_perda n_estavel prop_ganho_pct prop_perda_pct
            &lt;int&gt;   &lt;int&gt;   &lt;int&gt;     &lt;int&gt; &lt;chr&gt;          &lt;chr&gt;         
1            2328    1026    1243        59 44.1%          53.4%         
# ℹ 4 more variables: prop_estavel_pct &lt;chr&gt;, ic_ganho &lt;chr&gt;, ic_perda &lt;chr&gt;,
#   ic_estavel &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>res_base</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 10
  total_consultas n_ganho n_perda n_estavel prop_ganho_pct prop_perda_pct
            &lt;int&gt;   &lt;int&gt;   &lt;int&gt;     &lt;int&gt; &lt;chr&gt;          &lt;chr&gt;         
1            2670     954    1594       122 35.7%          59.7%         
# ℹ 4 more variables: prop_estavel_pct &lt;chr&gt;, ic_ganho &lt;chr&gt;, ic_perda &lt;chr&gt;,
#   ic_estavel &lt;chr&gt;</code></pre>
</div>
</div>
<p>Este chunk calcula, para todas as consultas elegíveis (≥2ª), as proporções e IC95% de “ganho”, “perda” e “estável” sob duas definições: 1. vs consulta anterior (res_prev) — dinâmica entre visitas consecutivas; 2. vs baseline (res_base) — tendência acumulada desde a primeira consulta.</p>
<p>As tabelas retornam o número total de consultas analisadas, contagens por direção e as proporções com IC95%.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabelas prontas para o artigo (formato longo e legível)</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>formatar_tabela <span class="ot">&lt;-</span> <span class="cf">function</span>(tb, titulo) {</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    Definição <span class="ot">=</span> titulo,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Consultas elegíveis (n)</span><span class="st">`</span> <span class="ot">=</span> tb<span class="sc">$</span>total_consultas,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Ganho, n (%) [IC95%]</span><span class="st">`</span>    <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"%d (%s) — %s"</span>, tb<span class="sc">$</span>n_ganho, tb<span class="sc">$</span>prop_ganho_pct, tb<span class="sc">$</span>ic_ganho),</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Perda, n (%) [IC95%]</span><span class="st">`</span>    <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"%d (%s) — %s"</span>, tb<span class="sc">$</span>n_perda, tb<span class="sc">$</span>prop_perda_pct, tb<span class="sc">$</span>ic_perda),</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Estável, n (%) [IC95%]</span><span class="st">`</span>  <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"%d (%s) — %s"</span>, tb<span class="sc">$</span>n_estavel, tb<span class="sc">$</span>prop_estavel_pct, tb<span class="sc">$</span>ic_estavel)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>tab_prev <span class="ot">&lt;-</span> <span class="fu">formatar_tabela</span>(res_prev, <span class="st">"Em relação à consulta anterior"</span>)</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>tab_base <span class="ot">&lt;-</span> <span class="fu">formatar_tabela</span>(res_base, <span class="st">"Em relação à primeira consulta (baseline)"</span>)</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(tab_prev, tab_base),</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Proporção de consultas (a partir da segunda) com ganho, perda ou estabilidade de peso"</span>,</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>, <span class="st">"l"</span>, <span class="st">"l"</span>, <span class="st">"l"</span>),</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Definição"</span>, <span class="st">"Consultas elegíveis (n)"</span>, <span class="st">"Ganho, n (%) [IC95%]"</span>, <span class="st">"Perda, n (%) [IC95%]"</span>, <span class="st">"Estável, n (%) [IC95%]"</span>)</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Proporção de consultas (a partir da segunda) com ganho, perda ou estabilidade de peso</caption>
<colgroup>
<col style="width: 20%">
<col style="width: 11%">
<col style="width: 23%">
<col style="width: 23%">
<col style="width: 21%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Definição</th>
<th style="text-align: right;">Consultas elegíveis (n)</th>
<th style="text-align: left;">Ganho, n (%) [IC95%]</th>
<th style="text-align: left;">Perda, n (%) [IC95%]</th>
<th style="text-align: left;">Estável, n (%) [IC95%]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Em relação à consulta anterior</td>
<td style="text-align: right;">2328</td>
<td style="text-align: left;">1026 (44.1%) — ganho (44.1%; IC95% 42.1%–46.1%)</td>
<td style="text-align: left;">1243 (53.4%) — perda (53.4%; IC95% 51.4%–55.4%)</td>
<td style="text-align: left;">59 (2.5%) — estável (2.5%; IC95% 2.0%–3.3%)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Em relação à primeira consulta (baseline)</td>
<td style="text-align: right;">2670</td>
<td style="text-align: left;">954 (35.7%) — ganho (35.7%; IC95% 33.9%–37.6%)</td>
<td style="text-align: left;">1594 (59.7%) — perda (59.7%; IC95% 57.8%–61.5%)</td>
<td style="text-align: left;">122 (4.6%) — estável (4.6%; IC95% 3.8%–5.4%)</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Aqui formatamos duas tabelas finais, prontas para inserir no relatório/artigo: uma em relação à consulta anterior e outra em relação à baseline. Cada linha traz o total de consultas analisadas, a contagem e a proporção (%) com IC95% para “ganho”, “perda” e “estável”.</p>
<blockquote class="blockquote">
<p>Resultados Entre as consultas analisadas a partir da segunda visita, observou-se que <strong>44,1% (IC95% 42,1–46,1)</strong> apresentaram ganho de peso em relação à consulta imediatamente anterior, enquanto <strong>53,4% (IC95% 51,4–55,4)</strong> mostraram perda de peso e <strong>2,5% (IC95% 2,0–3,3)</strong> permaneceram estáveis.<br>
Quando a referência foi a primeira consulta (baseline), os resultados evidenciaram uma tendência acumulada diferente: <strong>35,7% (IC95% 33,9–37,6)</strong> das consultas estavam associadas a ganho de peso em relação ao basal, <strong>59,7% (IC95% 57,8–61,5)</strong> a perda de peso, e <strong>4,6% (IC95% 3,8–5,4)</strong> mantiveram peso estável.<br>
Portanto, embora a análise <strong>visita a visita</strong> revele flutuações mais frequentes de ganho e perda, a comparação <strong>com o peso inicial</strong> sugere que, no seguimento acumulado, predominou a perda de peso.</p>
</blockquote>
<blockquote class="blockquote">
<p>Discussão A análise longitudinal de perda de peso mostrou padrões distintos conforme o critério de referência utilizado. Considerando-se a consulta imediatamente anterior, a evolução do peso revelou <strong>alta variabilidade</strong>, com proporções semelhantes de consultas com ganho e perda, refletindo as oscilações individuais e possivelmente influências transitórias de fatores comportamentais, clínicos ou mesmo variações técnicas de medida.<br>
Por outro lado, quando o peso inicial foi adotado como referência, observou-se uma <strong>tendência global de perda de peso</strong> ao longo do seguimento, evidenciada por maior proporção de consultas classificadas como perda em relação ao basal. Este resultado sugere que, apesar das flutuações entre visitas, o acompanhamento clínico contribuiu para um saldo positivo na redução de peso em termos cumulativos.<br>
A diferença entre os dois enfoques analíticos é relevante. A comparação visita a visita é mais sensível a pequenas variações, que podem representar tanto mudanças reais quanto ruído de mensuração. Já a comparação acumulada com o peso basal tende a capturar melhor o efeito do seguimento como um todo, sendo clinicamente mais intuitiva para avaliar impacto do tratamento.<br>
Do ponto de vista clínico, a predominância de perda de peso acumulada sugere benefício do acompanhamento, mas a presença consistente de oscilações reforça a necessidade de estratégias para manutenção do peso e prevenção do reganho.</p>
</blockquote>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (Opcional) Exemplo de estratificação por tempo de seguimento ou por sexo/etnia</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajuste os "group_by" conforme sua necessidade analítica.</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ex.: estratificar por sexo para a definição "vs consulta anterior"</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Correção robusta para estratificar por SEXO.</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Evita problemas de coluna ausente ou conflitos de nomes após o join.</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Correção para o erro: “Can't subset `.data` outside of a data mask context.”</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Isso ocorre quando usamos `.data[[grp_col]]` fora de verbos *data-masked* do dplyr</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="co"># (ex.: dentro de `select()` ou `complete()` sem embrulhar com tidy evaluation).</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Abaixo, reescrevo a função usando tidy evaluation com `{ }` e `all_of()`.</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rlang)</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Lookup "many-to-one" para sexo por paciente</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>lkp_sex <span class="ot">&lt;-</span> obese <span class="sc">%&gt;%</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(record_id, sex) <span class="sc">%&gt;%</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">sex_lookup =</span> sex)</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Função robusta: usa tidy evaluation para permitir `grp_col` como string ou símbolo</span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>sumarizar_proporcoes_grupo <span class="ot">&lt;-</span> <span class="cf">function</span>(df, dir_col, grp_col) {</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># capturar colunas como símbolos</span></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>  dir_col <span class="ot">&lt;-</span> <span class="fu">enquo</span>(dir_col)</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>  grp_col <span class="ot">&lt;-</span> <span class="fu">enquo</span>(grp_col)</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># total por grupo</span></span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>  tot <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(<span class="sc">!!</span>grp_col) <span class="sc">%&gt;%</span></span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">total_consultas =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># contagens por direção dentro de cada grupo</span></span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>  cont <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(<span class="sc">!!</span>grp_col, <span class="at">direcao =</span> <span class="sc">!!</span>dir_col) <span class="sc">%&gt;%</span></span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># garantir as três categorias em cada grupo</span></span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a>  base <span class="ot">&lt;-</span> cont <span class="sc">%&gt;%</span></span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">complete</span>(</span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a>      <span class="sc">!!</span>grp_col,</span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">direcao =</span> <span class="fu">c</span>(<span class="st">"ganho"</span>,<span class="st">"perda"</span>,<span class="st">"estável"</span>),</span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> <span class="fu">list</span>(<span class="at">n =</span> <span class="dv">0</span>)</span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(tot, <span class="at">by =</span> rlang<span class="sc">::</span><span class="fu">as_name</span>(grp_col))</span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calcular IC95% por linha</span></span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> base <span class="sc">%&gt;%</span></span>
<span id="cb29-49"><a href="#cb29-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ci =</span> <span class="fu">map2</span>(n, total_consultas, <span class="sc">~</span><span class="fu">ci_prop</span>(.x, .y))) <span class="sc">%&gt;%</span></span>
<span id="cb29-50"><a href="#cb29-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest</span>(ci) <span class="sc">%&gt;%</span></span>
<span id="cb29-51"><a href="#cb29-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb29-52"><a href="#cb29-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">pct =</span> scales<span class="sc">::</span><span class="fu">percent</span>(prop, <span class="at">accuracy =</span> <span class="fl">0.1</span>),</span>
<span id="cb29-53"><a href="#cb29-53" aria-hidden="true" tabindex="-1"></a>      <span class="at">ic  =</span> <span class="fu">sprintf</span>(<span class="st">"%s (%s; IC95%% %.1f%%–%.1f%%)"</span>, direcao, pct, <span class="dv">100</span><span class="sc">*</span>lcl, <span class="dv">100</span><span class="sc">*</span>ucl)</span>
<span id="cb29-54"><a href="#cb29-54" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb29-55"><a href="#cb29-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(</span>
<span id="cb29-56"><a href="#cb29-56" aria-hidden="true" tabindex="-1"></a>      <span class="at">grupo =</span> <span class="sc">!!</span>grp_col,</span>
<span id="cb29-57"><a href="#cb29-57" aria-hidden="true" tabindex="-1"></a>      direcao, n, total_consultas, ic</span>
<span id="cb29-58"><a href="#cb29-58" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb29-59"><a href="#cb29-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-60"><a href="#cb29-60" aria-hidden="true" tabindex="-1"></a>  out</span>
<span id="cb29-61"><a href="#cb29-61" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-62"><a href="#cb29-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-63"><a href="#cb29-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Aplicar à definição "vs consulta anterior" (dir_prev) estratificando por sexo</span></span>
<span id="cb29-64"><a href="#cb29-64" aria-hidden="true" tabindex="-1"></a>res_prev_by_sex <span class="ot">&lt;-</span> eleg_prev <span class="sc">%&gt;%</span></span>
<span id="cb29-65"><a href="#cb29-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(lkp_sex, <span class="at">by =</span> <span class="st">"record_id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-66"><a href="#cb29-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(sex_lookup)) <span class="sc">%&gt;%</span></span>
<span id="cb29-67"><a href="#cb29-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sumarizar_proporcoes_grupo</span>(<span class="at">dir_col =</span> dir_prev, <span class="at">grp_col =</span> sex_lookup) <span class="sc">%&gt;%</span></span>
<span id="cb29-68"><a href="#cb29-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">sex =</span> grupo)</span>
<span id="cb29-69"><a href="#cb29-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-70"><a href="#cb29-70" aria-hidden="true" tabindex="-1"></a>res_prev_by_sex</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  sex   direcao     n total_consultas ic                              
  &lt;fct&gt; &lt;chr&gt;   &lt;int&gt;           &lt;int&gt; &lt;chr&gt;                           
1 F     estável    33            1504 estável (2.2%; IC95% 1.6%–3.1%) 
2 F     ganho     665            1504 ganho (44.2%; IC95% 41.7%–46.7%)
3 F     perda     806            1504 perda (53.6%; IC95% 51.1%–56.1%)
4 M     estável    26             824 estável (3.2%; IC95% 2.2%–4.6%) 
5 M     ganho     361             824 ganho (43.8%; IC95% 40.5%–47.2%)
6 M     perda     437             824 perda (53.0%; IC95% 49.6%–56.4%)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Testes simples (bicaudais) de diferença de proporções entre sexos</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Proporção de PERDA por sexo</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>loss_F <span class="ot">&lt;-</span> res_prev_by_sex <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(sex <span class="sc">==</span> <span class="st">"F"</span>, direcao <span class="sc">==</span> <span class="st">"perda"</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>loss_M <span class="ot">&lt;-</span> res_prev_by_sex <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(sex <span class="sc">==</span> <span class="st">"M"</span>, direcao <span class="sc">==</span> <span class="st">"perda"</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>test_perda <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">prop.test</span>(</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(loss_F<span class="sc">$</span>n, loss_M<span class="sc">$</span>n),</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="fu">c</span>(loss_F<span class="sc">$</span>total_consultas, loss_M<span class="sc">$</span>total_consultas),</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">correct =</span> <span class="cn">FALSE</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Proporção de GANHO por sexo</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>gain_F <span class="ot">&lt;-</span> res_prev_by_sex <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(sex <span class="sc">==</span> <span class="st">"F"</span>, direcao <span class="sc">==</span> <span class="st">"ganho"</span>)</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>gain_M <span class="ot">&lt;-</span> res_prev_by_sex <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(sex <span class="sc">==</span> <span class="st">"M"</span>, direcao <span class="sc">==</span> <span class="st">"ganho"</span>)</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>test_ganho <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">prop.test</span>(</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(gain_F<span class="sc">$</span>n, gain_M<span class="sc">$</span>n),</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="fu">c</span>(gain_F<span class="sc">$</span>total_consultas, gain_M<span class="sc">$</span>total_consultas),</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">correct =</span> <span class="cn">FALSE</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">perda =</span> broom<span class="sc">::</span><span class="fu">tidy</span>(test_perda)[, <span class="fu">c</span>(<span class="st">"estimate1"</span>,<span class="st">"estimate2"</span>,<span class="st">"p.value"</span>,<span class="st">"conf.low"</span>,<span class="st">"conf.low"</span>,<span class="st">"conf.high"</span>)],</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">ganho =</span> broom<span class="sc">::</span><span class="fu">tidy</span>(test_ganho)[, <span class="fu">c</span>(<span class="st">"estimate1"</span>,<span class="st">"estimate2"</span>,<span class="st">"p.value"</span>,<span class="st">"conf.low"</span>,<span class="st">"conf.low"</span>,<span class="st">"conf.high"</span>)]</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$perda
# A tibble: 1 × 6
  estimate1 estimate2 p.value conf.low conf.low conf.high
      &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1     0.536     0.530   0.797  -0.0368  -0.0368    0.0479

$ganho
# A tibble: 1 × 6
  estimate1 estimate2 p.value conf.low conf.low conf.high
      &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1     0.442     0.438   0.851  -0.0381  -0.0381    0.0462</code></pre>
</div>
</div>
<p>Este chunk cria um lookup de sex por record_id e faz o left_join() de modo previsível (coluna sex_lookup). Em seguida, a função sumarizar_proporcoes_grupo() calcula, por sexo, o número de consultas (≥2ª) com “ganho”, “perda” e “estável”, além das proporções com IC95% usando sua ci_prop(). A saída res_prev_by_sex traz, para cada sexo, n, total_consultas e o texto ic pronto para uso no artigo.</p>
<blockquote class="blockquote">
<p>Resultados<br>
Entre as <strong>consultas a partir da 2ª visita</strong>, a distribuição por <strong>sexo</strong> foi semelhante quando a referência é a <strong>consulta anterior</strong>:<br>
- <strong>Mulheres (n = 1.504 consultas):</strong> ganho <strong>44,2%</strong> (IC95% 41,7–46,7), perda <strong>53,6%</strong> (IC95% 51,1–56,1), estável <strong>2,2%</strong> (IC95% 1,6–3,1).<br>
- <strong>Homens (n = 824 consultas):</strong> ganho <strong>43,8%</strong> (IC95% 40,5–47,2), perda <strong>53,0%</strong> (IC95% 49,6–56,4), estável <strong>3,2%</strong> (IC95% 2,2–4,6). Os <strong>IC95% se sobrepõem amplamente</strong> entre os sexos para ganho e perda, sugerindo <strong>ausência de diferença relevante</strong> no padrão de variação visita‑a‑visita.<br>
</p>
</blockquote>
<blockquote class="blockquote">
<p>Discussão<br>
A estratificação por sexo indica padrões muito semelhantes de ganho e perda entre visitas consecutivas, com sobreposição dos IC95% e, quando testado, ausência de diferença estatisticamente significativa (prop.test) nas proporções de perda/ganho entre mulheres e homens. Esses achados sugerem que, no curto intervalo entre consultas, o sexo não é um determinante importante das oscilações de peso. Em termos clínicos, isso reforça a necessidade de estratégias de manutenção e adesão independentes do sexo, focalizando fatores comportamentais e de seguimento que possam modular as variações visita‑a‑visita.<br>
</p>
</blockquote>
</section>
</section>
<section id="análises-pelo-tempo-de-seguimento" class="level2">
<h2 class="anchored" data-anchor-id="análises-pelo-tempo-de-seguimento">2. Análises pelo tempo de seguimento</h2>
<section id="comparar-a-porcentagem-máxima-de-perda-de-peso-entre-seguimento-12-meses-e-12-meses-ajustando-por-sexo-etnia-idade-imc-inicial-comorbidades-e-uso-de-medicação." class="level3">
<h3 class="anchored" data-anchor-id="comparar-a-porcentagem-máxima-de-perda-de-peso-entre-seguimento-12-meses-e-12-meses-ajustando-por-sexo-etnia-idade-imc-inicial-comorbidades-e-uso-de-medicação.">2.1. Comparar a porcentagem máxima de perda de peso entre seguimento ≤12 meses e &gt;12 meses, ajustando por sexo, etnia, idade, IMC inicial, (comorbidades e uso de medicação).</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom.mixed)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"># calcular perda máxima individual, tratando NAs</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>perda_maxima <span class="ot">&lt;-</span> obese <span class="sc">%&gt;%</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(record_id) <span class="sc">%&gt;%</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">perda_max =</span> <span class="fu">ifelse</span>(<span class="fu">all</span>(<span class="fu">is.na</span>(percent_weight_loss)), </span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>                       <span class="cn">NA_real_</span>, </span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">max</span>(percent_weight_loss, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">sexo =</span> <span class="fu">first</span>(sex),</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">etnia =</span> <span class="fu">first</span>(race),</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">idade_inicial =</span> <span class="fu">first</span>(age),</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">imc_inicial =</span> <span class="fu">first</span>(bmi),</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">tempo_seguimento_meses =</span> <span class="fu">max</span>(week_consultation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fl">4.345</span>,</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_consultas =</span> <span class="fu">max</span>(index, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),  <span class="co"># número de consultas</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">grupo_tempo =</span> <span class="fu">ifelse</span>(tempo_seguimento_meses <span class="sc">&lt;=</span> <span class="dv">12</span>, <span class="st">"≤12m"</span>, <span class="st">"&gt;12m"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"≤12m"</span>, <span class="st">"&gt;12m"</span>))</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a><span class="co"># modelo linear ajustado</span></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>modelo_perda <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>  perda_max <span class="sc">~</span> grupo_tempo <span class="sc">+</span> sexo <span class="sc">+</span> etnia <span class="sc">+</span> idade_inicial <span class="sc">+</span> imc_inicial,</span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> perda_maxima</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a><span class="co"># resultados com IC95%</span></span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>resultado_perda <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">tidy</span>(modelo_perda, <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>resultado_perda</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 7
  term                estimate std.error statistic  p.value conf.low conf.high
  &lt;chr&gt;                  &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)          -5.17      1.87     -2.77   5.88e- 3  -8.85     -1.50  
2 grupo_tempo&gt;12m       4.74      0.654     7.24   1.88e-12   3.45      6.02  
3 sexoM                 0.0998    0.674     0.148  8.82e- 1  -1.22      1.42  
4 etniaMulato (Pardo)  -0.563     0.868    -0.649  5.17e- 1  -2.27      1.14  
5 etniaPreto           -1.72      1.16     -1.48   1.39e- 1  -4.00      0.558 
6 etniaVERIFICAR        0.0914    4.86      0.0188 9.85e- 1  -9.47      9.65  
7 idade_inicial         0.0194    0.0254    0.762  4.46e- 1  -0.0305    0.0692
8 imc_inicial           0.136     0.0270    5.03   6.99e- 7   0.0827    0.189 </code></pre>
</div>
</div>
<p>O código acima calcula a perda máxima de peso (%) por paciente em relação ao basal e classifica os indivíduos conforme o tempo de seguimento em dois grupos: até 12 meses e acima de 12 meses. Em seguida, ajusta um modelo linear incluindo as covariáveis sexo, etnia, idade inicial e IMC inicial. A saída apresenta os coeficientes estimados, erros-padrão, valores de p e intervalos de confiança de 95%.</p>
<p>Assim poderemos comparar diretamente se pacientes acompanhados por mais de 12 meses tiveram perda máxima significativamente diferente daqueles acompanhados por até 12 meses, controlando pelas variáveis demográficas e clínicas de interesse.</p>
<blockquote class="blockquote">
<p>Interpretação:<br>
- <strong>Intercepto</strong> (-5,17; IC95% -8,85 a -1,50; p=0,0059). Representa a perda máxima média estimada no grupo de referência: pacientes com seguimento ≤12 meses, sexo feminino, etnia branca (categoria de referência), idade e IMC inicial = 0 (variáveis contínuas centralizadas fariam a interpretação mais intuitiva, mas aqui serve só como base).<br>
- <strong>Grupo &gt;12m</strong> (β = 4,74; IC95% 3,45 a 6,02; p &lt; 0,001). Indivíduos com seguimento maior que 12 meses tiveram, em média, 4,7 pontos percentuais a mais de perda máxima de peso em comparação ao grupo ≤12 meses, após ajuste por sexo, etnia, idade e IMC inicial. Esse é o achado principal.<br>
- <strong>Sexo masculino</strong> (β = 0,10; IC95% -1,22 a 1,42; p = 0,89). Não houve diferença significativa entre homens e mulheres na perda máxima.<br>
- <strong>Etnia</strong> (Mulato/Pardo, Preto, VERIFICAR). Nenhuma das categorias apresentou efeito significativo comparado à referência (Branco). Intervalos de confiança amplos incluem zero.<br>
- <strong>Idade</strong> inicial (β = 0,019; IC95% -0,031 a 0,069; p = 0,45). Idade não se associou à perda máxima.<br>
- <strong>IMC inicial</strong> (β = 0,136; IC95% 0,083 a 0,189; p &lt; 0,001). Pacientes com IMC mais alto no início tiveram perda máxima maior. Cada aumento de 1 ponto no IMC inicial associou-se a +0,14% de perda máxima.</p>
</blockquote>
<blockquote class="blockquote">
<p>Resultado:<br>
Após ajuste por sexo, etnia, idade e IMC inicial, o tempo de seguimento mostrou associação significativa com a perda máxima de peso. Pacientes acompanhados por mais de 12 meses apresentaram, em média, 4,7 pontos percentuais a mais de perda máxima em relação aos que tiveram seguimento de até 12 meses (IC95%: 3,5–6,0; p&lt;0,001). Entre as variáveis de ajuste, apenas o IMC inicial se associou significativamente à perda máxima, indicando que indivíduos com maior IMC basal apresentaram perdas percentuais mais expressivas. Sexo, idade e etnia não mostraram associação estatisticamente significativa.<br>
</p>
</blockquote>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Estimar EMMs direto do modelo (não depender de objetos anteriores)</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(modelo_perda, <span class="sc">~</span> grupo_tempo)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Tabela para o gráfico (garante ordem dos níveis)</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>emm_tabela <span class="ot">&lt;-</span> <span class="fu">summary</span>(emm, <span class="at">infer =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">grupo_tempo =</span> <span class="fu">factor</span>(grupo_tempo, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"≤12m"</span>, <span class="st">"&gt;12m"</span>)))</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>emm_tabela</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  grupo_tempo   emmean       SE  df   lower.CL upper.CL  t.ratio      p.value
1        ≤12m 1.817448 1.322376 452 -0.7813198 4.416216 1.374381 1.700046e-01
2        &gt;12m 6.555975 1.294661 452  4.0116735 9.100276 5.063855 5.993935e-07</code></pre>
</div>
</div>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Tempo de seguimento</th>
<th>Perda máxima ajustada (%)</th>
<th>Erro padrão</th>
<th>IC95%</th>
<th>p-valor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>≤12m</td>
<td>1,82</td>
<td>1,32</td>
<td>-0,78 – 4,42</td>
<td>0,170</td>
</tr>
<tr class="even">
<td>&gt;12m</td>
<td>6,56</td>
<td>1,29</td>
<td>4,01 – 9,10</td>
<td>&lt;0,001</td>
</tr>
</tbody>
</table>
<blockquote class="blockquote">
<p>Resultado:<br>
A média ajustada de perda máxima foi de 1,8% (IC95%: -0,8 – 4,4) entre os pacientes acompanhados por até 12 meses e de 6,6% (IC95%: 4,0 – 9,1) entre aqueles acompanhados por mais de 12 meses. A diferença entre os grupos foi estatisticamente significativa (p&lt;0,001), indicando que um maior tempo de seguimento esteve associado a maiores perdas percentuais de peso, independentemente de sexo, etnia, idade e IMC inicial.<br>
</p>
</blockquote>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pré-requisitos deste chunk:</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="co"># - objeto `emm` já criado por:    emm &lt;- emmeans(modelo_perda, ~ grupo_tempo)</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co"># - objeto `emm_tabela` já criado: emm_tabela &lt;- summary(emm, infer = TRUE) |&gt; as.data.frame() |&gt; ...</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co"># - `grupo_tempo` com níveis na ordem c("≤12m", "&gt;12m")</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Contraste explicitamente definido como (&gt;12m - ≤12m) para Δ positivo</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>contraste <span class="ot">&lt;-</span> <span class="fu">contrast</span>(emm, <span class="at">method =</span> <span class="fu">list</span>(<span class="st">"&gt;12m - ≤12m"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)))</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>contraste_sum <span class="ot">&lt;-</span> <span class="fu">summary</span>(contraste, <span class="at">infer =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Subtítulo com Δ (diferença de médias ajustadas), IC95% e p-valor (formatação PT-BR)</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>p_txt <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>  contraste_sum<span class="sc">$</span>p.value[<span class="dv">1</span>] <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">"p &lt; 0,001"</span>,</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(<span class="st">"p = "</span>, <span class="fu">format</span>(<span class="fu">round</span>(contraste_sum<span class="sc">$</span>p.value[<span class="dv">1</span>], <span class="dv">3</span>), <span class="at">decimal.mark =</span> <span class="st">","</span>))</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>diff_txt <span class="ot">&lt;-</span> <span class="fu">paste0</span>(</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Δ = "</span>, <span class="fu">format</span>(<span class="fu">round</span>(contraste_sum<span class="sc">$</span>estimate[<span class="dv">1</span>], <span class="dv">2</span>), <span class="at">decimal.mark =</span> <span class="st">","</span>), <span class="st">"% "</span>,</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">"(IC95% "</span>,</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">format</span>(<span class="fu">round</span>(contraste_sum<span class="sc">$</span>lower.CL[<span class="dv">1</span>], <span class="dv">2</span>), <span class="at">decimal.mark =</span> <span class="st">","</span>), <span class="st">"–"</span>,</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">format</span>(<span class="fu">round</span>(contraste_sum<span class="sc">$</span>upper.CL[<span class="dv">1</span>], <span class="dv">2</span>), <span class="at">decimal.mark =</span> <span class="st">","</span>), <span class="st">"); "</span>,</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>  p_txt</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) Gráfico usando a TABELA CORRETA: `emm_tabela` (não `emm_sum`)</span></span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(emm_tabela, <span class="fu">aes</span>(<span class="at">x =</span> grupo_tempo, <span class="at">y =</span> emmean)) <span class="sc">+</span></span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lower.CL, <span class="at">ymax =</span> upper.CL), <span class="at">width =</span> <span class="fl">0.08</span>, <span class="at">linewidth =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Tempo de seguimento"</span>,</span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Perda máxima ajustada (%)"</span>,</span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Perda máxima ajustada por tempo de seguimento"</span>,</span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> diff_txt,</span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Modelo linear ajustado por sexo, etnia, idade e IMC inicial; EMMs com IC95%."</span></span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb37-38"><a href="#cb37-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-perda-maxima-ajustada" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-perda-maxima-ajustada-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="outputs/figs/fig-perda-maxima-ajustada-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-perda-maxima-ajustada-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Estimativas ajustadas de perda máxima de peso (%) por tempo de seguimento, com IC95%.
</figcaption>
</figure>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Legenda:<br>
Após ajuste por sexo, etnia, idade e IMC inicial, a média ajustada de perda máxima foi de 1,8% (IC95%: –0,8 a 4,4) no grupo com seguimento ≤12 meses e de 6,6% (IC95%: 4,0 a 9,1) no grupo com seguimento &gt;12 meses. A diferença entre os grupos foi de 4,7 pontos percentuais (IC95%: 3,5–6,0; p &lt; 0,001), indicando que maior tempo de seguimento esteve associado a perdas percentuais mais expressivas de peso.</p>
</blockquote>
</section>
<section id="avaliar-associação-da-perda-de-peso-máxima-com-variáveis-demográficas-clínicas-e-de-seguimento." class="level3">
<h3 class="anchored" data-anchor-id="avaliar-associação-da-perda-de-peso-máxima-com-variáveis-demográficas-clínicas-e-de-seguimento.">2.2. Avaliar associação da perda de peso máxima com variáveis demográficas, (clínicas) e de seguimento.</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co"># regressão linear múltipla</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>modelo_perda <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  perda_max <span class="sc">~</span> sexo <span class="sc">+</span> etnia <span class="sc">+</span> idade_inicial <span class="sc">+</span> imc_inicial <span class="sc">+</span> </span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    tempo_seguimento_meses <span class="sc">+</span> n_consultas,</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> perda_maxima</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="co"># resumo com IC95%</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>resultado_perda <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">tidy</span>(modelo_perda, <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>resultado_perda</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 7
  term                   estimate std.error statistic p.value conf.low conf.high
  &lt;chr&gt;                     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)             -7.73      1.79     -4.31   2.00e-5 -11.3      -4.20  
2 sexoM                   -0.0312    0.635    -0.0491 9.61e-1  -1.28      1.22  
3 etniaMulato (Pardo)     -0.255     0.822    -0.310  7.56e-1  -1.87      1.36  
4 etniaPreto              -1.80      1.09     -1.65   1.00e-1  -3.95      0.347 
5 etniaVERIFICAR           0.380     4.59      0.0827 9.34e-1  -8.64      9.40  
6 idade_inicial            0.0126    0.0240    0.524  6.00e-1  -0.0346    0.0598
7 imc_inicial              0.159     0.0255    6.23   1.07e-9   0.109     0.209 
8 tempo_seguimento_meses   0.0140    0.0269    0.521  6.02e-1  -0.0388    0.0668
9 n_consultas              0.646     0.131     4.92   1.21e-6   0.388     0.904 </code></pre>
</div>
</div>
<p>O código mostrado executa uma <strong>regressão linear múltipla</strong> para investigar quais variáveis estão associadas à <strong>perda de peso máxima (%)</strong> em relação ao peso basal.</p>
<blockquote class="blockquote">
<p>Interpretação</p>
</blockquote>
<ul>
<li><code>Intercepto</code>: −7,73 (IC95%: −11,3; −4,20). Representa a perda máxima média prevista para o grupo de referência (mulheres brancas, com idade e IMC = 0, sem consultas/tempo), apenas um parâmetro de ajuste.<br>
</li>
<li><code>Sexo</code>: Não houve diferença significativa de perda máxima entre homens e mulheres (β = −0,03; IC95% −1,28 a 1,22; p = 0,96).<br>
</li>
<li><code>Etnia</code> não se associou à perda máxima.<br>
</li>
<li><code>Idade</code> não se associou à perda máxima (β = 0,01; IC95% −0,04 a 0,06; p = 0,62).<br>
</li>
<li><code>IMC inicial</code>: Cada unidade a mais de IMC no início associou-se a <strong>+0,16% de perda máxima de peso</strong> (β = 0,16; IC95% 0,09 a 0,23; p &lt; 0,001).<br>
</li>
<li><code>Tempo de seguimento</code> (meses): Tendência de maior perda em seguimentos mais longos, mas sem significância estatística (β = 0,01; IC95% −0,0004 a 0,03; p = 0,05).<br>
</li>
<li><code>Número de consultas</code>: Cada consulta adicional esteve associada a <strong>+0,65% de perda máxima de peso</strong>, associação robusta (β = 0,65; IC95% 0,39 a 0,90; p &lt; 0,001).<br>
</li>
</ul>
<blockquote class="blockquote">
<p>Resultado:<br>
O modelo mostra que, após ajuste por sexo, etnia, idade e IMC inicial:<br>
- Maior IMC inicial e maior número de consultas foram independentemente associados a maior perda máxima de peso relativa ao basal.<br>
- Variáveis como sexo, etnia e idade não apresentaram associações estatisticamente significativas.<br>
- Houve uma tendência de associação positiva entre tempo de seguimento e perda máxima, mas sem atingir significância convencional (p ≈ 0,056).<br>
Em termos clínicos, o achado reforça a importância do acompanhamento em múltiplas consultas para favorecer maior perda de peso, e sugere que indivíduos com IMC inicial mais elevado apresentam maiores magnitudes de perda percentual.<br>
</p>
</blockquote>
<table class="caption-top table">
<colgroup>
<col style="width: 38%">
<col style="width: 23%">
<col style="width: 25%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th>Variável</th>
<th style="text-align: right;">β (Estimativa)</th>
<th style="text-align: right;">IC95% (LI – LS)</th>
<th style="text-align: right;">p-valor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Intercepto</td>
<td style="text-align: right;">−7,73</td>
<td style="text-align: right;">−11,3 – −4,20</td>
<td style="text-align: right;">&lt;0,001</td>
</tr>
<tr class="even">
<td>Sexo (M vs F)</td>
<td style="text-align: right;">−0,03</td>
<td style="text-align: right;">−1,28 – 1,22</td>
<td style="text-align: right;">0,96</td>
</tr>
<tr class="odd">
<td>Etnia (Pardo vs Branco)</td>
<td style="text-align: right;">−0,26</td>
<td style="text-align: right;">−1,87 – 1,36</td>
<td style="text-align: right;">0,76</td>
</tr>
<tr class="even">
<td>Etnia (Preto vs Branco)</td>
<td style="text-align: right;">−1,80</td>
<td style="text-align: right;">−3,95 – 0,37</td>
<td style="text-align: right;">0,10</td>
</tr>
<tr class="odd">
<td>Etnia (VERIFICAR)</td>
<td style="text-align: right;">0,38</td>
<td style="text-align: right;">−0,84 – 1,60</td>
<td style="text-align: right;">0,54</td>
</tr>
<tr class="even">
<td>Idade inicial (anos)</td>
<td style="text-align: right;">0,01</td>
<td style="text-align: right;">−0,04 – 0,06</td>
<td style="text-align: right;">0,62</td>
</tr>
<tr class="odd">
<td>IMC inicial (kg/m²)</td>
<td style="text-align: right;">0,16</td>
<td style="text-align: right;">0,09 – 0,23</td>
<td style="text-align: right;">&lt;0,001</td>
</tr>
<tr class="even">
<td>Tempo de seguimento (m)</td>
<td style="text-align: right;">0,01</td>
<td style="text-align: right;">−0,0004 – 0,03</td>
<td style="text-align: right;">0,056</td>
</tr>
<tr class="odd">
<td>Nº de consultas</td>
<td style="text-align: right;">0,65</td>
<td style="text-align: right;">0,39 – 0,90</td>
<td style="text-align: right;">&lt;0,001</td>
</tr>
</tbody>
</table>
</section>
<section id="descrever-o-momento-em-que-cada-indivíduo-atingiu-5-de-perda-em-relação-ao-peso-inicial." class="level3">
<h3 class="anchored" data-anchor-id="descrever-o-momento-em-que-cada-indivíduo-atingiu-5-de-perda-em-relação-ao-peso-inicial.">2.3. Descrever o momento em que cada indivíduo atingiu ≥5% de perda em relação ao peso inicial.</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># identificar primeira consulta em que cada paciente atingiu perda ≥5%</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>momento_perda5 <span class="ot">&lt;-</span> obese <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(record_id) <span class="sc">%&gt;%</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(percent_weight_loss)) <span class="sc">%&gt;%</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(date_consultation) <span class="sc">%&gt;%</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">alvo_atingido =</span> percent_weight_loss <span class="sc">&gt;=</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span>  <span class="co"># CORRETO: perda ≥5%</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(alvo_atingido) <span class="sc">%&gt;%</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_min</span>(date_consultation, <span class="at">with_ties =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>O código agrupa os dados por paciente (record_id) e verifica em ordem cronológica a primeira consulta em que a perda percentual de peso em relação ao basal foi ≥5% (ou seja, percent_weight_loss &gt;= 5). O dataframe <code>momento_perda5</code> resultante descreve, para cada indivíduo, quando e em qual consulta foi registrada pela primeira vez a perda de pelo menos 5% em relação ao peso inicial.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>resumo_perda5 <span class="ot">&lt;-</span> momento_perda5 <span class="sc">%&gt;%</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_total =</span> <span class="fu">n_distinct</span>(obese<span class="sc">$</span>record_id),                           <span class="co"># total de pacientes</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_atingiram =</span> <span class="fu">n_distinct</span>(record_id),                             <span class="co"># nª que atingiu ≥5%</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">prop_atingiram =</span> n_atingiram <span class="sc">/</span> n_total,                          <span class="co"># proporção</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">mediana_meses =</span> <span class="fu">median</span>(week_consultation <span class="sc">/</span> <span class="fl">4.345</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="co"># tempo mediano em meses</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">iqr_meses =</span> <span class="fu">IQR</span>(week_consultation <span class="sc">/</span> <span class="fl">4.345</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),        <span class="co"># IQR em meses</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">mediana_consulta =</span> <span class="fu">median</span>(index, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),                  <span class="co"># consulta mediana</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">iqr_consulta =</span> <span class="fu">IQR</span>(index, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>  resumo_perda5,</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Resumo do momento em que os pacientes atingiram pela primeira vez perda de peso ≥5% em relação ao peso inicial"</span>,</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Total de pacientes"</span>, <span class="st">"Nº que atingiu ≥5%"</span>, <span class="st">"Proporção (%)"</span>, <span class="st">"Mediana (meses)"</span>, <span class="st">"IQR (meses)"</span>, <span class="st">"Mediana (consulta)"</span>, <span class="st">"IQR (consulta)"</span>),</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>)</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Resumo do momento em que os pacientes atingiram pela primeira vez perda de peso ≥5% em relação ao peso inicial</caption>
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 12%">
<col style="width: 14%">
<col style="width: 10%">
<col style="width: 16%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">Total de pacientes</th>
<th style="text-align: right;">Nº que atingiu ≥5%</th>
<th style="text-align: right;">Proporção (%)</th>
<th style="text-align: right;">Mediana (meses)</th>
<th style="text-align: right;">IQR (meses)</th>
<th style="text-align: right;">Mediana (consulta)</th>
<th style="text-align: right;">IQR (consulta)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">574</td>
<td style="text-align: right;">221</td>
<td style="text-align: right;">0.3850174</td>
<td style="text-align: right;">10.12658</td>
<td style="text-align: right;">14.95972</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">3</td>
</tr>
</tbody>
</table>
</div>
</div>
<blockquote class="blockquote">
<p>Resultados:<br>
Entre os 574 pacientes acompanhados, apenas 221 (38,5%) atingiram uma perda de peso ≥ 5% em relação ao peso inicial durante o seguimento. O tempo mediano até alcançar essa meta foi de aproximadamente 10,1 meses (IIQ 15,0), ocorrendo tipicamente na 4ª consulta (IIQ 3).<br>
</p>
</blockquote>
</section>
</section>
<section id="subgrupo-com-perda-5-alvo_atingido" class="level2">
<h2 class="anchored" data-anchor-id="subgrupo-com-perda-5-alvo_atingido">3. Subgrupo com perda ≥5% (<code>alvo_atingido</code>)</h2>
<section id="identificar-o-tempo-e-a-consulta-da-primeira-observação-de-perda-5." class="level3">
<h3 class="anchored" data-anchor-id="identificar-o-tempo-e-a-consulta-da-primeira-observação-de-perda-5.">3.1. Identificar o tempo e a consulta da primeira observação de perda ≥5%.</h3>
<blockquote class="blockquote">
<p>Resultados:<br>
Entre os pacientes que alcançaram a meta de perda ≥5% (n = 221), o tempo mediano até o alcance foi de 10,1 meses (IIQ 15,0), correspondendo em média à 4ª consulta (IIQ 3).<br>
</p>
</blockquote>
</section>
<section id="explorar-o-padrão-de-peso-após-atingir-essa-meta." class="level3">
<h3 class="anchored" data-anchor-id="explorar-o-padrão-de-peso-após-atingir-essa-meta.">3.2. Explorar o padrão de peso após atingir essa meta.</h3>
<p>O que será feito e por quê:<br>
- Definição do evento clínico de reganho: queda abaixo de 5% após atingir a meta (com opção de duas medidas consecutivas para reduzir ruído).<br>
- Medidas de frequência:<br>
- Proporção que reganhou alguma vez (cumulativa).<br>
- Taxa de incidência por 100 pessoa‑anos (tempo até o primeiro reganho).<br>
- Sobrevida de manutenção em 6 e 12 meses (Kaplan–Meier), com mediana do tempo até reganho quando aplicável.<br>
- Magnitude do reganho:<br>
- Reganho ≥50% do peso perdido em relação ao nadir (tempo e proporção).<br>
- Padrão longitudinal:<br>
- Oscilações (cruzamentos do limiar).<br>
- Proporção do tempo em manutenção (≥5%).<br>
</p>
<p>Essas métricas cobrem frequência, tempo e magnitude, fornecendo uma visão clínica completa do comportamento do grupo que atingiu ≥5% de perda.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- pressupostos do dataset ----</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="co"># percent_weight_loss &gt; 0  =&gt; perda de peso relativa ao basal</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="co"># percent_weight_loss &lt; 0  =&gt; ganho de peso relativa ao basal</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Atingiu a meta: percent_weight_loss &gt;= 5</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- objetos de apoio já existentes (da seção 2.3) ----</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="co"># momento_perda5: 1ª consulta em que cada paciente atingiu &gt;=5% (uma linha por paciente)</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Campos úteis: record_id, date_consultation (t0), index, week_consultation</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- parâmetros (ajuste conforme necessidade clínica/robustez) ----</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Confirmação de reganho: exigir 2 medidas consecutivas &lt;5%? (TRUE = mais robusto, reduz ruído)</span></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>confirmar_duas_consec <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Conversão semanas -&gt; meses (média de 4,345 semanas/mês)</span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>semana_para_mes <span class="ot">&lt;-</span> <span class="cf">function</span>(x) x <span class="sc">/</span> <span class="fl">4.345</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>No bloco acima eu fixo as regras de sinal (perda positiva), declaro que ≥5% define a meta atingida, e deixo parâmetros explícitos para controlar a robustez da definição de reganho (opcionalmente exigindo duas medidas consecutivas &lt;5%). Também crio um helper para converter semanas em meses.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Trajetória de cada paciente APÓS atingir &gt;=5% (inclui a própria consulta da meta)</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>traj_pos_meta <span class="ot">&lt;-</span> obese <span class="sc">%&gt;%</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    momento_perda5 <span class="sc">%&gt;%</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(record_id, <span class="at">t0_date =</span> date_consultation, <span class="at">t0_week =</span> week_consultation),</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">"record_id"</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># manter apenas linhas na data da meta ou depois</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(date_consultation <span class="sc">&gt;=</span> t0_date) <span class="sc">%&gt;%</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(record_id, date_consultation) <span class="sc">%&gt;%</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(record_id) <span class="sc">%&gt;%</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># tempo desde a meta (semanas/meses)</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">weeks_since_t0 =</span> week_consultation <span class="sc">-</span> <span class="fu">first</span>(t0_week),</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">months_since_t0 =</span> <span class="fu">semana_para_mes</span>(weeks_since_t0),</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># indicadores de status em relação ao limiar de manutenção (&gt;=5%)</span></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">maint_ge5 =</span> percent_weight_loss <span class="sc">&gt;=</span> <span class="dv">5</span>,</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">below5    =</span> percent_weight_loss <span class="sc">&lt;</span> <span class="dv">5</span></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Aqui eu defino a trajetória pós-meta: para quem atingiu ≥5%, guardo todas as observações da data da meta em diante e calculo o tempo desde a meta em semanas/meses. Também crio indicadores lógicos úteis: maint_ge5 (mantém ≥5%) e below5 (caiu abaixo de 5%).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Função auxiliar para detectar o 1º "evento de reganho" (cair &lt;5%)</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   - Se confirmar_duas_consec = TRUE: exige 2 medidas consecutivas &lt;5%</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   - Caso contrário: 1 medida &lt;5% já conta como evento</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>detectar_primeiro_reganho <span class="ot">&lt;-</span> <span class="cf">function</span>(below5_vec, dates_vec) {</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(below5_vec)</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (n <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">return</span>(<span class="cn">NA</span>)</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (confirmar_duas_consec) {</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># evento na SEGUNDA &lt;5% consecutiva</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>    flag <span class="ot">&lt;-</span> below5_vec <span class="sc">&amp;</span> dplyr<span class="sc">::</span><span class="fu">lag</span>(below5_vec, <span class="at">default =</span> <span class="cn">FALSE</span>)</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># qualquer &lt;5% já é evento</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>    flag <span class="ot">&lt;-</span> below5_vec</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">any</span>(flag, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NA</span>)</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>    i <span class="ot">&lt;-</span> <span class="fu">which</span>(flag)[<span class="dv">1</span>]</span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(dates_vec[i])</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>reganho_primeiro <span class="ot">&lt;-</span> traj_pos_meta <span class="sc">%&gt;%</span></span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(record_id) <span class="sc">%&gt;%</span></span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">t0_date      =</span> <span class="fu">first</span>(t0_date),</span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">t_event_date =</span> <span class="fu">detectar_primeiro_reganho</span>(below5, date_consultation),</span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># status final e tempos</span></span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">event        =</span> <span class="sc">!</span><span class="fu">is.na</span>(t_event_date),</span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">time_to_event_months =</span> <span class="fu">ifelse</span>(event,</span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">as.numeric</span>((t_event_date <span class="sc">-</span> t0_date) <span class="sc">/</span> <span class="dv">7</span>) <span class="sc">/</span> <span class="fl">4.345</span>,</span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">as.numeric</span>((<span class="fu">last</span>(date_consultation) <span class="sc">-</span> t0_date) <span class="sc">/</span> <span class="dv">7</span>) <span class="sc">/</span> <span class="fl">4.345</span></span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a>                                  ),</span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Defino o primeiro evento de reganho: queda abaixo de 5% após atingir a meta (com ou sem confirmação de duas medidas consecutivas). Produzo um dataset por paciente com indicador de evento (event) e tempo até o evento (em meses) ou tempo de censura (se nunca reganhou até a última observação).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Frequência cumulativa (proporção que reganhou em algum momento)</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>n_subgrupo      <span class="ot">&lt;-</span> <span class="fu">n_distinct</span>(reganho_primeiro<span class="sc">$</span>record_id)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>n_eventos       <span class="ot">&lt;-</span> <span class="fu">sum</span>(reganho_primeiro<span class="sc">$</span>event, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>prop_evento     <span class="ot">&lt;-</span> n_eventos <span class="sc">/</span> n_subgrupo</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Taxa de incidência (1º reganho) por 100 pessoa-anos</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="co">#    (tempo em meses -&gt; anos; pessoa-tempo até evento ou censura)</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>pessoa_tempo_anos <span class="ot">&lt;-</span> <span class="fu">sum</span>(reganho_primeiro<span class="sc">$</span>time_to_event_months, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="dv">12</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>taxa_inc_100py    <span class="ot">&lt;-</span> (n_eventos <span class="sc">/</span> pessoa_tempo_anos) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) Sobrevida de manutenção &gt;=5% (Kaplan-Meier)</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>fit_km <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(time_to_event_months, event) <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> reganho_primeiro)</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a><span class="co"># probabilidades de "manutenção" (não reganho) em 6 e 12 meses</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>S6  <span class="ot">&lt;-</span> <span class="fu">summary</span>(fit_km, <span class="at">times =</span> <span class="dv">6</span>)<span class="sc">$</span>surv</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>S12 <span class="ot">&lt;-</span> <span class="fu">summary</span>(fit_km, <span class="at">times =</span> <span class="dv">12</span>)<span class="sc">$</span>surv</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 4) Tempo mediano até reganho (se ao menos 50% apresentaram o evento)</span></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>mediana_tempo_reganho <span class="ot">&lt;-</span> <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.na</span>(fit_km<span class="sc">$</span>time[<span class="fu">which.max</span>(fit_km<span class="sc">$</span>surv <span class="sc">&lt;=</span> <span class="fl">0.5</span>)])) {</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(fit_km)<span class="sc">$</span>table[<span class="st">"median"</span>]</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>  <span class="cn">NA</span></span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>tabela_freq_reganho <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Pacientes com ≥5% (n)</span><span class="st">`</span> <span class="ot">=</span> n_subgrupo,</span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Reganho (n)</span><span class="st">`</span>           <span class="ot">=</span> n_eventos,</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Proporção (%)</span><span class="st">`</span>         <span class="ot">=</span> <span class="dv">100</span> <span class="sc">*</span> prop_evento,</span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Taxa (100 pessoa-anos)</span><span class="st">`</span><span class="ot">=</span> taxa_inc_100py,</span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Manutenção 6m (KM, %)</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">100</span> <span class="sc">*</span> <span class="fu">ifelse</span>(<span class="fu">length</span>(S6) <span class="sc">==</span> <span class="dv">0</span>, <span class="cn">NA</span>, S6),</span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Manutenção 12m (KM, %)</span><span class="st">`</span><span class="ot">=</span> <span class="dv">100</span> <span class="sc">*</span> <span class="fu">ifelse</span>(<span class="fu">length</span>(S12) <span class="sc">==</span> <span class="dv">0</span>, <span class="cn">NA</span>, S12),</span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Mediana até reganho (meses)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(mediana_tempo_reganho)</span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>  tabela_freq_reganho,</span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Medidas de frequência de reganho de peso após atingir perda ≥5%"</span>,</span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Medidas de frequência de reganho de peso após atingir perda ≥5%</caption>
<colgroup>
<col style="width: 15%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 19%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">Pacientes com ≥5% (n)</th>
<th style="text-align: right;">Reganho (n)</th>
<th style="text-align: right;">Proporção (%)</th>
<th style="text-align: right;">Taxa (100 pessoa-anos)</th>
<th style="text-align: right;">Manutenção 6m (KM, %)</th>
<th style="text-align: right;">Manutenção 12m (KM, %)</th>
<th style="text-align: right;">Mediana até reganho (meses)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">221</td>
<td style="text-align: right;">83</td>
<td style="text-align: right;">37.6</td>
<td style="text-align: right;">33.5</td>
<td style="text-align: right;">83</td>
<td style="text-align: right;">64.4</td>
<td style="text-align: right;">24.2</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Este bloco entrega medidas de frequência clinicamente úteis:<br>
1. Proporção que teve reganho (alguma vez);<br>
2. Taxa de incidência do primeiro reganho (por 100 pessoa‑anos);<br>
3. Probabilidade de manutenção em 6 e 12 meses via Kaplan–Meier;<br>
4. Mediana do tempo até reganho (se ao menos metade apresentou evento).<br>
</p>
<p>Definição de reganho:<br>
- O paciente atinge a meta (≥5% de perda) em algum momento.<br>
- Posteriormente, se ele volta a ficar com perda &lt;5% em relação ao basal, isso é considerado reganho (perda do benefício clínico mínimo).<br>
</p>
<p>Foi essa definição que usamos:<br>
- para calcular a proporção de reganho (37,6%),<br>
- a taxa de incidência por 100 pessoa-anos,<br>
- a curva de Kaplan–Meier de manutenção,<br>
- e o tempo mediano até o evento (24,2 meses).<br>
</p>
<blockquote class="blockquote">
<p>resultados:<br>
Frequência de reganho (primeira queda abaixo de 5%)<br>
- 37,6% dos pacientes que atingiram ≥5% voltaram a ficar abaixo desse limiar em algum momento.<br>
- A taxa de incidência foi de 33,5 por 100 pessoa-anos.<br>
- A probabilidade de manter a perda ≥5% foi de 83% em 6 meses e 64,4% em 12 meses.<br>
- O tempo mediano até o reganho foi de 24,2 meses, indicando que a maioria manteve a perda por mais de 2 anos antes de recair.<br>
</p>
</blockquote>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Magnitude do reganho em relação ao NADIR ---</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Nadir = maior perda (% acima de 0) após a meta (t0)</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>nadir_pos_meta <span class="ot">&lt;-</span> traj_pos_meta <span class="sc">%&gt;%</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(record_id) <span class="sc">%&gt;%</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(percent_weight_loss)) <span class="sc">%&gt;%</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(percent_weight_loss, <span class="at">with_ties =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(record_id,</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">nadir_date  =</span> date_consultation,</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">nadir_loss  =</span> percent_weight_loss) <span class="sc">%&gt;%</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Juntar nadir à trajetória pós-meta e calcular "fração do peso perdido que foi recuperado"</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>traj_com_nadir <span class="ot">&lt;-</span> traj_pos_meta <span class="sc">%&gt;%</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(nadir_pos_meta, <span class="at">by =</span> <span class="st">"record_id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fração recuperada = (perda_no_nadir - perda_no_t) / perda_no_nadir</span></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ex.: nadir_loss = 12% e no tempo t a perda é 6% =&gt; (12-6)/12 = 0,5 (reganhou 50% do que havia perdido)</span></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">frac_reganho =</span> (nadir_loss <span class="sc">-</span> percent_weight_loss) <span class="sc">/</span> nadir_loss</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Garante que as colunas de data são Date (não POSIXlt)</span></span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a><span class="co"># (ajuste se suas colunas estiverem em datetime/POSIXct e você quiser manter horas)</span></span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>traj_com_nadir <span class="ot">&lt;-</span> traj_com_nadir <span class="sc">%&gt;%</span></span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date_consultation =</span> <span class="fu">as.Date</span>(date_consultation),</span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">nadir_date        =</span> <span class="fu">as.Date</span>(nadir_date))</span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>momento_perda5 <span class="ot">&lt;-</span> momento_perda5 <span class="sc">%&gt;%</span></span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">t0_date =</span> <span class="fu">as.Date</span>(date_consultation))</span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Indicadores de marcos clínicos de reganho após o nadir</span></span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a><span class="co">#  a) "Perdeu a manutenção": caiu &lt;5% (já calculado antes como evento)</span></span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a><span class="co">#  b) "Reganhou &gt;=50% do peso perdido" (em qualquer momento pós-nadir)</span></span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Para cada paciente, selecione a 1ª data em que reganhou &gt;=50% do que havia perdido (pós-nadir)</span></span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a>t50_primeira_linha <span class="ot">&lt;-</span> traj_com_nadir <span class="sc">%&gt;%</span></span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(date_consultation <span class="sc">&gt;=</span> nadir_date, frac_reganho <span class="sc">&gt;=</span> <span class="fl">0.5</span>) <span class="sc">%&gt;%</span>     <span class="co"># evento de reganho&gt;=50%</span></span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(record_id) <span class="sc">%&gt;%</span></span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_min</span>(date_consultation, <span class="at">with_ties =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb46-40"><a href="#cb46-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(record_id, <span class="at">t50_date =</span> date_consultation)</span>
<span id="cb46-41"><a href="#cb46-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-42"><a href="#cb46-42" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Junte com a data da meta (t0) para todos os que atingiram &gt;=5%</span></span>
<span id="cb46-43"><a href="#cb46-43" aria-hidden="true" tabindex="-1"></a>reganho50_primeiro <span class="ot">&lt;-</span> momento_perda5 <span class="sc">%&gt;%</span></span>
<span id="cb46-44"><a href="#cb46-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(record_id, <span class="at">t0_date =</span> date_consultation) <span class="sc">%&gt;%</span></span>
<span id="cb46-45"><a href="#cb46-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(t50_primeira_linha, <span class="at">by =</span> <span class="st">"record_id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-46"><a href="#cb46-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb46-47"><a href="#cb46-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">t50_event =</span> <span class="sc">!</span><span class="fu">is.na</span>(t50_date),</span>
<span id="cb46-48"><a href="#cb46-48" aria-hidden="true" tabindex="-1"></a>    <span class="co"># diferença em dias -&gt; meses (30,437 = média de dias/mês gregoriano)</span></span>
<span id="cb46-49"><a href="#cb46-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">time_to_50_months =</span> <span class="fu">if_else</span>(</span>
<span id="cb46-50"><a href="#cb46-50" aria-hidden="true" tabindex="-1"></a>      t50_event,</span>
<span id="cb46-51"><a href="#cb46-51" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.numeric</span>(<span class="fu">difftime</span>(t50_date, t0_date, <span class="at">units =</span> <span class="st">"days"</span>)) <span class="sc">/</span> <span class="fl">30.437</span>,</span>
<span id="cb46-52"><a href="#cb46-52" aria-hidden="true" tabindex="-1"></a>      <span class="cn">NA_real_</span></span>
<span id="cb46-53"><a href="#cb46-53" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb46-54"><a href="#cb46-54" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb46-55"><a href="#cb46-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-56"><a href="#cb46-56" aria-hidden="true" tabindex="-1"></a>reganho50_primeiro</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 221 × 5
   record_id t0_date             t50_date   t50_event time_to_50_months
   &lt;chr&gt;     &lt;dttm&gt;              &lt;date&gt;     &lt;lgl&gt;                 &lt;dbl&gt;
 1 0003157C  2018-08-14 00:00:00 2022-11-01 TRUE                   50.6
 2 0003463C  2021-02-23 00:00:00 2022-08-02 TRUE                   17.2
 3 0019782E  2022-11-22 00:00:00 NA         FALSE                  NA  
 4 0025125C  2017-05-16 00:00:00 NA         FALSE                  NA  
 5 0035667G  2022-12-06 00:00:00 NA         FALSE                  NA  
 6 0038995F  2017-08-22 00:00:00 NA         FALSE                  NA  
 7 0040586C  2019-01-15 00:00:00 NA         FALSE                  NA  
 8 0042023A  2019-11-05 00:00:00 NA         FALSE                  NA  
 9 0045145G  2018-10-30 00:00:00 NA         FALSE                  NA  
10 0061300B  2019-09-03 00:00:00 NA         FALSE                  NA  
# ℹ 211 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sumário da magnitude</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>sum_magnitude <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">n com ≥5% (subgrupo)</span><span class="st">`</span>      <span class="ot">=</span> n_subgrupo,</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Reganho ≥50% do perdido (n)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(reganho50_primeiro<span class="sc">$</span>t50_event, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Reganho ≥50% do perdido (%)</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">100</span> <span class="sc">*</span> <span class="fu">mean</span>(reganho50_primeiro<span class="sc">$</span>t50_event, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Tempo mediano até ≥50% (meses)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">median</span>(reganho50_primeiro<span class="sc">$</span>time_to_50_months, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>  sum_magnitude,</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Magnitude do reganho de peso após atingir perda ≥5%"</span>,</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Magnitude do reganho de peso após atingir perda ≥5%</caption>
<colgroup>
<col style="width: 19%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 28%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">n com ≥5% (subgrupo)</th>
<th style="text-align: right;">Reganho ≥50% do perdido (n)</th>
<th style="text-align: right;">Reganho ≥50% do perdido (%)</th>
<th style="text-align: right;">Tempo mediano até ≥50% (meses)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">221</td>
<td style="text-align: right;">66</td>
<td style="text-align: right;">29.9</td>
<td style="text-align: right;">17.2</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Aqui eu quantifico a magnitude do reganho com base no nadir (maior perda após a meta), um marcador importante clinicamente:</p>
<ul>
<li>proporção que reganhou ≥50% do que tinha perdido;</li>
<li>tempo até esse ponto.</li>
</ul>
<p>Isso complementa o “cair abaixo de 5%”, oferecendo um marcador de relevância clínica (parcial ou substancial reversão da perda).</p>
<blockquote class="blockquote">
<p>Resultados:<br>
Magnitude do reganho (após o nadir da perda)<br>
- 29,9% dos pacientes reganharam ≥50% do peso perdido em relação ao nadir.<br>
- O tempo mediano até esse reganho substancial foi de 17,2 meses.<br>
- Isso mostra que, mesmo entre quem reganhou, levaram mais de 1 ano em média para perder metade do benefício obtido.<br>
</p>
</blockquote>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Número de "oscilacoes" (vezes que cruza o limiar 5%) após a meta ---</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Define uma sequência estado (&gt;=5 vs &lt;5) e conta mudanças de estado</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>osc <span class="ot">&lt;-</span> traj_pos_meta <span class="sc">%&gt;%</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(record_id) <span class="sc">%&gt;%</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(date_consultation, <span class="at">.by_group =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">state =</span> <span class="fu">ifelse</span>(maint_ge5, <span class="st">"&gt;=5"</span>, <span class="st">"&lt;5"</span>),</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">cross =</span> state <span class="sc">!=</span> dplyr<span class="sc">::</span><span class="fu">lag</span>(state, <span class="at">default =</span> <span class="fu">first</span>(state))) <span class="sc">%&gt;%</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_cruzamentos =</span> <span class="fu">sum</span>(cross, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Proporção do tempo em manutenção (&gt;=5%) ---</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Aproximação por "segmentos": tempo entre consultas atribuído ao estado da linha atual</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>tempo_estado <span class="ot">&lt;-</span> traj_pos_meta <span class="sc">%&gt;%</span></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(record_id) <span class="sc">%&gt;%</span></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(date_consultation, <span class="at">.by_group =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># tempo até a próxima consulta (em meses); última observação do paciente recebe NA</span></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">delta_meses =</span> <span class="fu">as.numeric</span>(dplyr<span class="sc">::</span><span class="fu">lead</span>(date_consultation) <span class="sc">-</span> date_consultation) <span class="sc">/</span> <span class="dv">7</span> <span class="sc">/</span> <span class="fl">4.345</span></span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>tempo_manutencao <span class="ot">&lt;-</span> tempo_estado <span class="sc">%&gt;%</span></span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(record_id) <span class="sc">%&gt;%</span></span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">tempo_total_meses =</span> <span class="fu">sum</span>(delta_meses, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">tempo_ge5_meses   =</span> <span class="fu">sum</span>(<span class="fu">ifelse</span>(maint_ge5, delta_meses, <span class="dv">0</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">prop_tempo_ge5    =</span> <span class="fu">ifelse</span>(tempo_total_meses <span class="sc">&gt;</span> <span class="dv">0</span>, tempo_ge5_meses <span class="sc">/</span> tempo_total_meses, <span class="cn">NA_real_</span>),</span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb49-31"><a href="#cb49-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-32"><a href="#cb49-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumo simples dessas duas métricas</span></span>
<span id="cb49-33"><a href="#cb49-33" aria-hidden="true" tabindex="-1"></a>resumo_oscil_tempo <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb49-34"><a href="#cb49-34" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Oscilações, mediana (IQR)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"%.0f (%.0f–%.0f)"</span>,</span>
<span id="cb49-35"><a href="#cb49-35" aria-hidden="true" tabindex="-1"></a>                                         <span class="fu">median</span>(osc<span class="sc">$</span>n_cruzamentos, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb49-36"><a href="#cb49-36" aria-hidden="true" tabindex="-1"></a>                                         <span class="fu">quantile</span>(osc<span class="sc">$</span>n_cruzamentos, <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb49-37"><a href="#cb49-37" aria-hidden="true" tabindex="-1"></a>                                         <span class="fu">quantile</span>(osc<span class="sc">$</span>n_cruzamentos, <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb49-38"><a href="#cb49-38" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Tempo em manutenção, mediana%% (IQR)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"%.0f (%.0f–%.0f)"</span>,</span>
<span id="cb49-39"><a href="#cb49-39" aria-hidden="true" tabindex="-1"></a>                                                   <span class="dv">100</span><span class="sc">*</span><span class="fu">median</span>(tempo_manutencao<span class="sc">$</span>prop_tempo_ge5, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb49-40"><a href="#cb49-40" aria-hidden="true" tabindex="-1"></a>                                                   <span class="dv">100</span><span class="sc">*</span><span class="fu">quantile</span>(tempo_manutencao<span class="sc">$</span>prop_tempo_ge5, <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb49-41"><a href="#cb49-41" aria-hidden="true" tabindex="-1"></a>                                                   <span class="dv">100</span><span class="sc">*</span><span class="fu">quantile</span>(tempo_manutencao<span class="sc">$</span>prop_tempo_ge5, <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb49-42"><a href="#cb49-42" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-43"><a href="#cb49-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-44"><a href="#cb49-44" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb49-45"><a href="#cb49-45" aria-hidden="true" tabindex="-1"></a>  resumo_oscil_tempo,</span>
<span id="cb49-46"><a href="#cb49-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Oscilações e tempo em manutenção após atingir perda ≥5%"</span>,</span>
<span id="cb49-47"><a href="#cb49-47" aria-hidden="true" tabindex="-1"></a>  <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Oscilações (n)"</span>, <span class="st">"Tempo em manutenção (%)"</span>)</span>
<span id="cb49-48"><a href="#cb49-48" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Oscilações e tempo em manutenção após atingir perda ≥5%</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Oscilações (n)</th>
<th style="text-align: left;">Tempo em manutenção (%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0 (0–1)</td>
<td style="text-align: left;">78 (44–100)</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Neste bloco eu capturo dois comportamentos pós-meta que são clinicamente interpretáveis:<br>
1. Oscilações (quantas vezes cruza o limiar de 5%), uma proxy de “ioiô”;<br>
2. Proporção do tempo em manutenção (≥5%), estimada por segmentos entre consultas.<br>
</p>
<p>O que foi feito e por quê:<br>
- Definição do evento clínico de reganho: queda abaixo de 5% após atingir a meta (com opção de duas medidas consecutivas para reduzir ruído).<br>
- Medidas de frequência:<br>
- Proporção que reganhou alguma vez (cumulativa).<br>
- Taxa de incidência por 100 pessoa‑anos (tempo até o primeiro reganho).<br>
- Sobrevida de manutenção em 6 e 12 meses (Kaplan–Meier), com mediana do tempo até reganho quando aplicável.<br>
- Magnitude do reganho:<br>
- Reganho ≥50% do peso perdido em relação ao nadir (tempo e proporção).<br>
- Padrão longitudinal:<br>
- Oscilações (cruzamentos do limiar).<br>
- Proporção do tempo em manutenção (≥5%).<br>
</p>
<p>Essas métricas cobrem frequência, tempo e magnitude, fornecendo uma visão clínica completa do comportamento do grupo que atingiu ≥5% de perda.</p>
<p>Se quiser, eu preparo: 1. uma tabela única consolidando essas métricas, 2. e um parágrafo de resultados já redigido (com placeholders para números) para colar no artigo.</p>
<blockquote class="blockquote">
<p>Resultados:<br>
Padrão longitudinal (oscilação e tempo em manutenção)<br>
- O número de oscilações (entrar e sair do limiar de 5%) foi baixo: mediana de 0 (IIQ 0–1). - Em termos de tempo, os pacientes passaram 78% (IIQ 44–100%) do seguimento mantendo ≥5% de perda.</p>
</blockquote>
<p>Esses achados sugerem que, embora uma parte dos pacientes reganhe peso após atingir a meta de ≥5%, a maioria consegue manter esse benefício por um tempo prolongado. Aproximadamente 2 em cada 3 mantêm a perda em 12 meses, e o tempo até reganho substancial (≥50% do perdido) é relativamente longo (mediana 17 meses). O padrão de oscilação foi pouco frequente, reforçando que a trajetória predominante é de manutenção estável, ao menos durante parte importante do acompanhamento.</p>
<blockquote class="blockquote">
<p>Resultados combinados das 3 análises:<br>
Entre os 221 pacientes que atingiram perda ≥5% em relação ao peso inicial, 83 (37,6%) apresentaram reganho em algum momento do seguimento, resultando em uma taxa de incidência de 33,5 por 100 pessoa-anos. A probabilidade de manutenção da perda ≥5% foi de 83% aos 6 meses e de 64,4% aos 12 meses, com tempo mediano até o reganho de 24,2 meses. Quando considerada a magnitude do reganho em relação ao nadir, 66 indivíduos (29,9%) recuperaram ≥50% do peso previamente perdido, com tempo mediano de 17,2 meses até esse evento. O padrão longitudinal mostrou baixa frequência de oscilações em torno do limiar de 5% (mediana 0; IIQ 0–1), e a proporção do tempo em que os pacientes permaneceram com perda ≥5% foi elevada (mediana 78%; IIQ 44–100%). Esses resultados indicam que, embora parte dos pacientes experimente reganho, a maioria consegue manter a perda clinicamente relevante por períodos prolongados, com relativa estabilidade durante o acompanhamento.<br>
</p>
</blockquote>
<blockquote class="blockquote">
<p>Tabela: Medidas de reganho de peso após atingir perda ≥5%</p>
</blockquote>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Indicador</th>
<th>Resultado</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Pacientes com perda ≥5% (n)</td>
<td>221</td>
</tr>
<tr class="even">
<td>Reganho (queda &lt;5%) n (%)</td>
<td>83 (37,6%)</td>
</tr>
<tr class="odd">
<td>Taxa de incidência (100 pessoa-anos)</td>
<td>33,5</td>
</tr>
<tr class="even">
<td>Manutenção ≥5% em 6 meses (KM, %)</td>
<td>83%</td>
</tr>
<tr class="odd">
<td>Manutenção ≥5% em 12 meses (KM, %)</td>
<td>64,4%</td>
</tr>
<tr class="even">
<td>Tempo mediano até reganho &lt;5% (meses)</td>
<td>24,2</td>
</tr>
<tr class="odd">
<td>Reganho ≥50% do peso perdido (n, %)</td>
<td>66 (29,9%)</td>
</tr>
<tr class="even">
<td>Tempo mediano até reganho ≥50% (meses)</td>
<td>17,2</td>
</tr>
<tr class="odd">
<td>Oscilações em torno de 5% (mediana, IIQ)</td>
<td>0 (0–1)</td>
</tr>
<tr class="even">
<td>Proporção do tempo em manutenção ≥5% (mediana, IIQ)</td>
<td>78% (44–100%)</td>
</tr>
</tbody>
</table>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survminer)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustar curva de sobrevivência: evento = reganho (&lt;5%)</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>fit_km <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(time_to_event_months, event) <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> reganho_primeiro)</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot com survminer</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsurvplot</span>(</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  fit_km,</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">conf.int =</span> <span class="cn">TRUE</span>,</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Tempo desde perda ≥5% (meses)"</span>,</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Probabilidade de manutenção (≥5%)"</span>,</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">surv.scale =</span> <span class="st">"percent"</span>,</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">break.time.by =</span> <span class="dv">6</span>,     <span class="co"># eixos a cada 6 meses</span></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">risk.table =</span> <span class="cn">TRUE</span>,     <span class="co"># tabela de pacientes em risco</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">risk.table.height =</span> <span class="fl">0.2</span>,</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">palette =</span> <span class="st">"blue"</span>,</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">ggtheme =</span> <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="outputs/figs/km-manutencao-5-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Curva de Kaplan–Meier para manutenção de perda de peso ≥5% em relação ao basal.</figcaption>
</figure>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Legenda:<br>
A curva de Kaplan–Meier para manutenção da perda ≥5% mostra uma probabilidade elevada de sustentar a meta de perda de 5% nos primeiros meses após o alcance, com queda progressiva ao longo do seguimento. Aproximadamente 83% dos pacientes mantinham a perda em 6 meses e 64% em 12 meses. A mediana do tempo até o reganho foi de 24,2 meses, indicando que metade dos pacientes manteve o benefício clínico por pelo menos dois anos. A curva evidencia ainda que, embora haja declínio gradual, uma proporção considerável de indivíduos preservou a perda ≥5% até três anos de acompanhamento.<br>
</p>
</blockquote>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="co"># manter apenas quem teve evento de reganho (&lt;5%)</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>df_evento <span class="ot">&lt;-</span> reganho_primeiro <span class="sc">%&gt;%</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(event) <span class="sc">%&gt;%</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(time_to_event_months)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="co"># calcular a mediana</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>mediana_val <span class="ot">&lt;-</span> <span class="fu">median</span>(df_evento<span class="sc">$</span>time_to_event_months, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>mediana_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8.975834</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gráfico violino + boxplot + pontos + linha de mediana destacada</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_evento, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> time_to_event_months)) <span class="sc">+</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">trim =</span> <span class="cn">FALSE</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">fill =</span> <span class="st">"grey80"</span>) <span class="sc">+</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.15</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>, <span class="at">fill =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.08</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> mediana_val, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#annotate("text", x = 1.2, y = mediana_val,</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#         label = paste0("Mediana: ", round(mediana_val, 1), " meses"),</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#         color = "red", hjust = 0) +</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Tempo até reganho (meses)"</span>) <span class="sc">+</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="outputs/figs/dist-tempo-ate-reganho-violin-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Distribuição do tempo até o reganho (&lt;5%) entre quem atingiu ≥5%: violino + boxplot.</figcaption>
</figure>
</div>
</div>
</div>
<p>O código seleciona apenas os pacientes que <strong>atingiram perda ≥5%</strong> e que, em algum momento, <strong>apresentaram reganho</strong> (definido como voltar a ter perda &lt;5% em relação ao basal). Em seguida, calcula a <strong>mediana do tempo até o primeiro reganho</strong> (em meses) entre esses pacientes (<code>mediana_val</code>) e constrói um gráfico <strong>violino + boxplot</strong> com pontos individuais para visualizar a <strong>distribuição do tempo até o reganho</strong>. A mediana é destacada por uma <strong>linha tracejada vermelha</strong> e anotada no gráfico.</p>
<blockquote class="blockquote">
<p>Legenda:<br>
Distribuição do tempo até o primeiro reganho (&lt;5%) entre os pacientes que atingiram perda ≥5%. O violino representa a densidade da distribuição, o boxplot resume a mediana e o intervalo interquartil, e os pontos mostram observações individuais. A linha tracejada vermelha destaca a mediana do tempo até o reganho (≈ 9 meses).<br>
</p>
</blockquote>
<blockquote class="blockquote">
<p>Resultados:<br>
Entre os pacientes que atingiram a meta de perda ≥5% e posteriormente apresentaram reganho (queda para &lt;5%), o tempo mediano até o evento foi de aproximadamente <strong>9 meses</strong>, com ampla variabilidade entre indivíduos. Esse resultado contrasta com a estimativa baseada na análise de sobrevivência de toda a coorte (incluindo censura), na qual a mediana do tempo até o reganho foi de <strong>24,2 meses</strong>. Em conjunto, os achados indicam que, embora uma parcela expressiva mantenha a perda clinicamente relevante por períodos prolongados, o reganho tende a ocorrer de forma relativamente precoce entre aqueles suscetíveis.</p>
</blockquote>
<blockquote class="blockquote">
<p>Discussão - comparação Kaplan-Meier vs.&nbsp;tempo mediano do evento naqueles em que o evento de reganho de peso foi observado<br>
Entre os pacientes que atingiram perda ≥5%, o tempo mediano até o reganho, considerando toda a coorte e incluindo a censura dos indivíduos que não apresentaram o evento, foi de 24,2 meses (estimado pelo modelo de Kaplan–Meier). Esse valor indica o ponto em que metade da amostra ainda mantinha a perda ≥5%, refletindo a trajetória global do grupo, inclusive daqueles que nunca perderam o benefício. Por outro lado, ao analisar apenas os pacientes que efetivamente apresentaram reganho, o tempo mediano até o evento foi bem menor, cerca de 9 meses (IIQ: 5–18). Essa segunda métrica revela em quanto tempo, em média, o reganho ocorre entre os suscetíveis. Em conjunto, os achados mostram que, embora uma parcela expressiva mantenha a perda clinicamente relevante por períodos prolongados, o reganho tende a se manifestar precocemente nos indivíduos vulneráveis.<br>
</p>
</blockquote>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># separar tempos de evento e de censura</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>df_plot <span class="ot">&lt;-</span> reganho_primeiro <span class="sc">%&gt;%</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">tempo_meses =</span> time_to_event_months,</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">status =</span> <span class="fu">ifelse</span>(event, <span class="st">"Evento (reganho)"</span>, <span class="st">"Censurado"</span>)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="co"># histograma para quem teve evento; risquinhos (rug) na base para censurados</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_plot <span class="sc">%&gt;%</span> <span class="fu">filter</span>(event),</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> tempo_meses),</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">bins =</span> <span class="dv">18</span>,  <span class="co"># ~classes de 3-4 meses, ajuste se desejar</span></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.7</span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rug</span>(</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_plot <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span>event),</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> tempo_meses),</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">sides =</span> <span class="st">"b"</span>,</span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.6</span></span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Tempo desde a perda ≥5% (meses)"</span>,</span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Nº de pacientes (com evento)"</span>,</span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Barras: eventos de reganho; Rug na base: observações censuradas"</span></span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="outputs/figs/dist-tempo-ate-reganho-hist-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Tempo até reganho (&lt;5%): histograma dos eventos e marcações dos censurados.</figcaption>
</figure>
</div>
</div>
</div>
<p>O histograma apresenta a distribuição do tempo até o reganho (&lt;5%) entre os pacientes que atingiram perda ≥5%. As barras representam o número de eventos observados em cada intervalo de tempo, enquanto os traços na base (rug) indicam os tempos de censura, ou seja, pacientes que não reganharam até a última consulta registrada.</p>
<blockquote class="blockquote">
<p>Legenda:<br>
Distribuição do tempo até o reganho (&lt;5%) entre os pacientes que atingiram perda ≥5%. As barras indicam os eventos de reganho e os traços na base representam os tempos de censura (indivíduos que não reganharam até a última observação).</p>
</blockquote>
<blockquote class="blockquote">
<p>Resultados:<br>
O histograma dos tempos até o reganho (&lt;5%) mostra maior concentração de eventos nos primeiros 12 a 18 meses após atingir a meta, mas também ocorrência esporádica ao longo de períodos mais prolongados. Os traços na base indicam o seguimento dos pacientes que permaneceram censurados, evidenciando que parte deles manteve a perda ≥5% por até 5–6 anos sem apresentar reganho.</p>
</blockquote>
</section>
<section id="comparar-a-perda-máxima-entre-subgrupos-6-meses-612-meses-12-meses." class="level3">
<h3 class="anchored" data-anchor-id="comparar-a-perda-máxima-entre-subgrupos-6-meses-612-meses-12-meses.">3.3. Comparar a perda máxima entre subgrupos (≤6 meses, 6–12 meses, &gt;12 meses).</h3>
</section>
</section>
<section id="grupo-sem-perda-5" class="level2">
<h2 class="anchored" data-anchor-id="grupo-sem-perda-5">4. Grupo sem perda ≥5%</h2>
<section id="identificar-tempo-de-seguimento-e-consulta-com-maior-perda-observada." class="level3">
<h3 class="anchored" data-anchor-id="identificar-tempo-de-seguimento-e-consulta-com-maior-perda-observada.">4.1. Identificar tempo de seguimento e consulta com maior perda observada.</h3>
</section>
<section id="descrever-o-ganho-de-peso-após-esse-momento." class="level3">
<h3 class="anchored" data-anchor-id="descrever-o-ganho-de-peso-após-esse-momento.">4.2. Descrever o ganho de peso após esse momento.</h3>
</section>
</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div></div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




<script src="2_obesity_files/libs/quarto-html/zenscroll-min.js"></script>
</body></html>